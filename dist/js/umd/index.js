!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("rxjs"));else if("function"==typeof define&&define.amd)define(["rxjs"],e);else{var r="object"==typeof exports?e(require("rxjs")):e(t.rxjs);for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(this,(function(t){return function(){"use strict";var e={391:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.ExpiringCrypto=e.JSONCrypto=void 0;var n=r(255),o=r(551),i=function(){function t(){}return t.prototype.decode=function(t){return(null==t?void 0:t.encryptedData)?JSON.parse(t.encryptedData):t},t.prototype.encode=function(t){return{encryptedData:JSON.stringify(t)}},t}();e.JSONCrypto=i;var a=function(){function t(t,e,r){this.timeout=t,this.parentCrypto=e,this.hashSum=r,this.gcCycleCnt=0,this.storedMessages={},this.lastCall=0}return t.prototype.decode=function(t){var e,r=(new Date).getTime();this.gcLimitReached(r)&&(this.storedMessages=o.LazyStream.ofAssoc(this.storedMessages).filter((function(t){return t[1]>=r})).collect(new n.AssocArrayCollector)),this.lastCall=r;var i=this.hashSum.encode(t);if(!(null===(e=this.storedMessages)||void 0===e?void 0:e[i.toString()]))throw Error("An item was tried to be decryted which either was expired or invalid");return this.parentCrypto.decode(t)},t.prototype.gcLimitReached=function(e){return this.lastCall+this.timeout<e||++this.gcCycleCnt%t.MAX_GC_CYCLES==0},t.prototype.encode=function(t){var e=this.parentCrypto.encode(t),r=this.hashSum.encode(e);return this.storedMessages[r.toString()]=(new Date).getTime()+this.timeout,e},t.MAX_GC_CYCLES=10,t}();e.ExpiringCrypto=a},585:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},i.apply(this,arguments)},a=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{l(n.next(t))}catch(t){i(t)}}function u(t){try{l(n.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}l((n=n.apply(t,e||[])).next())}))},u=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},s=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},c=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.DQ$=e.DQ=e.DomQueryCollector=e.DomQuery=e.Style=e.ElementAttribute=void 0;var p,h=r(152),f=r(551),d=r(255),y=r(805),v=y.Lang.trim,m=y.Lang.objToArray,b=y.Lang.isString,g=y.Lang.equalsIgnoreCase,S=r(456);function _(t,e,r){return void 0===r&&(r={attributes:!0,childList:!0,subtree:!0,timeout:500,interval:100}),new Promise((function(n,o){var a=null,u=new Error("Mutation observer timeout");function l(t,e){return e(t)?t:r.childList?e(t)?t:t.childNodes.filter((function(t){return e(t)})).first().value.value:r.subtree?e(t)?t:t.querySelectorAll(" * ").filter((function(t){return e(t)})).first().value.value:e(t)?t:null}var s=t;if(s=l(s,e))n(new O(s));else if("undefined"!=typeof MutationObserver){var c=setTimeout((function(){return a.disconnect(),o(u)}),r.timeout);a=new MutationObserver((function(r){var o=new O(r.map((function(t){return t.target}))).filter((function(t){return e(t)})).first();o.isPresent()&&(clearTimeout(c),a.disconnect(),n(new O(o||t)))}));var p=i({},r);delete p.timeout,t.eachElem((function(t){a.observe(t,p)}))}else var h=setInterval((function(){var r=l(t,e);r&&(f&&(clearTimeout(f),clearInterval(h),h=null),n(new O(r||t)))}),r.interval),f=setTimeout((function(){h&&(clearInterval(h),o(u))}),r.timeout)}))}!function(t){t.SELECT="select",t.BUTTON="button",t.SUBMIT="submit",t.RESET="reset",t.IMAGE="image",t.RADIO="radio",t.CHECKBOX="checkbox"}(p||(p={}));var E=function(t){function e(e,r,n){void 0===n&&(n=null);var o=t.call(this,e,r)||this;return o.element=e,o.name=r,o.defaultVal=n,o}return o(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t,e=(t=this.element.get(0)).orElse.apply(t,[]).values;return e.length?e[0].getAttribute(this.name):this.defaultVal},set:function(t){for(var e,r=(e=this.element.get(0)).orElse.apply(e,[]).values,n=0;n<r.length;n++)r[n].setAttribute(this.name,t);r[0].setAttribute(this.name,t)},enumerable:!1,configurable:!0}),e.prototype.getClass=function(){return e},e.fromNullable=function(t,r){return void 0===r&&(r="value"),new e(t,r)},e}(h.ValueEmbedder);e.ElementAttribute=E;var w=function(t){function e(e,r,n){void 0===n&&(n=null);var o=t.call(this,e,r)||this;return o.element=e,o.name=r,o.defaultVal=n,o}return o(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this.element.values;return t.length?t[0].style[this.name]:this.defaultVal},set:function(t){for(var e=this.element.values,r=0;r<e.length;r++)e[r].style[this.name]=t},enumerable:!1,configurable:!0}),e.prototype.getClass=function(){return E},e.fromNullable=function(t,e){return void 0===e&&(e="value"),new E(t,e)},e}(h.ValueEmbedder);e.Style=w;var A=function(){return!0},O=function(){function t(){for(var e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(this.rootNode=[],this.pos=-1,this._limits=-1,!h.Optional.fromNullable(r).isAbsent()&&r.length)for(var o=0;o<r.length;o++)if(r[o])if(b(r[o])){var i=t.querySelectorAll(r[o]);i.isAbsent()||r.push.apply(r,s([],l(i.values),!1))}else r[o]instanceof t?(e=this.rootNode).push.apply(e,s([],l(r[o].values),!1)):this.rootNode.push(r[o]);else;}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getAsElem(0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){return this.allElems()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"global",{get:function(){return S._global$},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return new E(this.get(0),"id")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this.rootNode.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tagName",{get:function(){return this.getAsElem(0).getIf("tagName")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nodeName",{get:function(){return this.getAsElem(0).getIf("nodeName")},enumerable:!1,configurable:!0}),t.prototype.isTag=function(t){return!this.isAbsent()&&(this.nodeName.orElse("__none___").value.toLowerCase()==t.toLowerCase()||this.tagName.orElse("__none___").value.toLowerCase()==t.toLowerCase())},Object.defineProperty(t.prototype,"type",{get:function(){return this.getAsElem(0).getIf("type")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return new h.ValueEmbedder(this.getAsElem(0).value,"name")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputValue",{get:function(){return this.getAsElem(0).getIf("value").isPresent()?new h.ValueEmbedder(this.getAsElem(0).value):h.ValueEmbedder.absent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"val",{get:function(){return this.inputValue.value},set:function(t){this.inputValue.value=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"checked",{get:function(){return f.Stream.of.apply(f.Stream,s([],l(this.values),!1)).allMatch((function(t){return!!t.checked}))},set:function(t){this.eachElem((function(e){return e.checked=t}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"elements",{get:function(){return this.querySelectorAll("input, checkbox, select, textarea, fieldset")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deepElements",{get:function(){return this.querySelectorAllDeep("input, select, textarea, checkbox, fieldset")},enumerable:!1,configurable:!0}),t.prototype.querySelectorAllDeep=function(e){var r=[],n=this.querySelectorAll(e);n.length&&r.push(n);var o=this.querySelectorAll("*").shadowRoot;if(o.length){var i=o.querySelectorAllDeep(e);i.length&&r.push(i)}return new(t.bind.apply(t,s([void 0],l(r),!1)))},Object.defineProperty(t.prototype,"disabled",{get:function(){return this.attr("disabled").isPresent()},set:function(t){t?this.attr("disabled").value="disabled":this.removeAttribute("disabled")},enumerable:!1,configurable:!0}),t.prototype.removeAttribute=function(t){this.eachElem((function(e){return e.removeAttribute(t)}))},Object.defineProperty(t.prototype,"childNodes",{get:function(){var e=[];return this.eachElem((function(t){e=e.concat(m(t.childNodes))})),new(t.bind.apply(t,s([void 0],l(e),!1)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stream",{get:function(){return new(f.Stream.bind.apply(f.Stream,s([void 0],l(this.asArray),!1)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lazyStream",{get:function(){return f.LazyStream.of.apply(f.LazyStream,s([],l(this.asArray),!1))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"asArray",{get:function(){return[].concat(f.LazyStream.of.apply(f.LazyStream,s([],l(this.rootNode),!1)).filter((function(t){return null!=t})).map((function(e){return t.byId(e)})).collect(new d.ArrayCollector))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetWidth",{get:function(){return f.LazyStream.of.apply(f.LazyStream,s([],l(this.rootNode),!1)).filter((function(t){return null!=t})).map((function(t){return t.offsetWidth})).reduce((function(t,e){return t+e}),0).value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetHeight",{get:function(){return f.LazyStream.of.apply(f.LazyStream,s([],l(this.rootNode),!1)).filter((function(t){return null!=t})).map((function(t){return t.offsetHeight})).reduce((function(t,e){return t+e}),0).value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetLeft",{get:function(){return f.LazyStream.of.apply(f.LazyStream,s([],l(this.rootNode),!1)).filter((function(t){return null!=t})).map((function(t){return t.offsetLeft})).reduce((function(t,e){return t+e}),0).value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetTop",{get:function(){return f.LazyStream.of.apply(f.LazyStream,s([],l(this.rootNode),!1)).filter((function(t){return null!=t})).map((function(t){return t.offsetTop})).reduce((function(t,e){return t+e}),0).value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"asNodeArray",{get:function(){return[].concat(f.Stream.of(this.rootNode).filter((function(t){return null!=t})).collect(new d.ArrayCollector))},enumerable:!1,configurable:!0}),t.querySelectorAllDeep=function(e){return new t(document).querySelectorAllDeep(e)},t.querySelectorAll=function(e){return-1!=e.indexOf("/shadow/")?new t(document)._querySelectorAllDeep(e):new t(document)._querySelectorAll(e)},t.byId=function(e,r){return void 0===r&&(r=!1),b(e)?r?new t(document).byIdDeep(e):new t(document).byId(e):new t(e)},t.byTagName=function(e){return b(e)?new t(document).byTagName(e):new t(e)},t.globalEval=function(e,r){return new t(document).globalEval(e,r)},t.globalEvalSticky=function(e,r){return new t(document).globalEvalSticky(e,r)},t.fromMarkup=function(e){var r=document.implementation.createHTMLDocument(""),n=(e=v(e)).toLowerCase();if(-1!=n.indexOf("<!doctype")||-1!=n.indexOf("<html")||-1!=n.indexOf("<head")||-1!=n.indexOf("<body"))return r.documentElement.innerHTML=e,new t(r.documentElement);var o=function(t,e){var r=["<",e,">"].join(""),n=["<",e," "].join("");return 0==t.indexOf(r)||0==t.indexOf(n)},i=new t(document.createElement("div"));return o(n,"thead")||o(n,"tbody")?(i.html("<table>".concat(e,"</table>")),i.querySelectorAll("table").get(0).childNodes.detach()):o(n,"tfoot")?(i.html("<table><thead></thead><tbody><tbody".concat(e,"</table>")),i.querySelectorAll("table").get(2).childNodes.detach()):o(n,"tr")?(i.html("<table><tbody>".concat(e,"</tbody></table>")),i.querySelectorAll("tbody").get(0).childNodes.detach()):o(n,"td")?(i.html("<table><tbody><tr>".concat(e,"</tr></tbody></table>")),i.querySelectorAll("tr").get(0).childNodes.detach()):(i.html(e),i.childNodes.detach())},t.prototype.get=function(e){return e<this.rootNode.length?new t(this.rootNode[e]):t.absent},t.prototype.getAsElem=function(t,e){return void 0===e&&(e=h.Optional.absent),t<this.rootNode.length?h.Optional.fromNullable(this.rootNode[t]):e},t.prototype.filesFromElem=function(t){var e;return t<this.rootNode.length&&(null===(e=this.rootNode[t])||void 0===e?void 0:e.files)?this.rootNode[t].files:[]},t.prototype.allElems=function(){return this.rootNode},t.prototype.isAbsent=function(){return 0==this.length},t.prototype.isPresent=function(t){var e=this.isAbsent();return!e&&t&&t.call(this,this),!e},t.prototype.ifPresentLazy=function(t){return void 0===t&&(t=function(){}),this.isPresent.call(this,t),this},t.prototype.delete=function(){this.eachElem((function(t){t.parentNode&&t.parentNode.removeChild(t)}))},t.prototype.querySelectorAll=function(t){return-1!=t.indexOf("/shadow/")?this._querySelectorAllDeep(t):this._querySelectorAll(t)},t.prototype._querySelectorAll=function(e){var r,n;if(!(null===(r=null==this?void 0:this.rootNode)||void 0===r?void 0:r.length))return this;for(var o=[],i=0;i<this.rootNode.length;i++)if(null===(n=this.rootNode[i])||void 0===n?void 0:n.querySelectorAll){var a=this.rootNode[i].querySelectorAll(e);o=o.concat(m(a))}return new(t.bind.apply(t,s([void 0],l(o),!1)))},t.prototype._querySelectorAllDeep=function(e){var r;if(!(null===(r=null==this?void 0:this.rootNode)||void 0===r?void 0:r.length))return this;for(var n=new(t.bind.apply(t,s([void 0],l(this.rootNode),!1))),o=e.split(/\/shadow\//),i=0;i<o.length;i++)if(""!=o[i]){var a=o[i];n=n.querySelectorAll(a),i<o.length-1&&(n=n.shadowRoot)}return n},t.prototype.byId=function(e,r){var n=[];return r&&(n=n.concat(f.LazyStream.of.apply(f.LazyStream,s([],l((null==this?void 0:this.rootNode)||[]),!1)).filter((function(t){return e==t.id})).map((function(e){return new t(e)})).collect(new d.ArrayCollector))),n=n.concat(this.querySelectorAll('[id="'.concat(e,'"]'))),new(t.bind.apply(t,s([void 0],l(n),!1)))},t.prototype.byIdDeep=function(e,r){var n=[];r&&(n=n.concat(f.LazyStream.of.apply(f.LazyStream,s([],l((null==this?void 0:this.rootNode)||[]),!1)).filter((function(t){return e==t.id})).map((function(e){return new t(e)})).collect(new d.ArrayCollector)));var o=this.querySelectorAllDeep('[id="'.concat(e,'"]'));return o.length&&n.push(o),new(t.bind.apply(t,s([void 0],l(n),!1)))},t.prototype.byTagName=function(e,r,n){var o,i=[];return r&&(i=f.LazyStream.of.apply(f.LazyStream,s([],l(null!==(o=null==this?void 0:this.rootNode)&&void 0!==o?o:[]),!1)).filter((function(t){return(null==t?void 0:t.tagName)==e})).reduce((function(t,e){return t.concat([e])}),i).orElse(i).value),n?i.push(this.querySelectorAllDeep(e)):i.push(this.querySelectorAll(e)),new(t.bind.apply(t,s([void 0],l(i),!1)))},t.prototype.attr=function(t,e){return void 0===e&&(e=null),new E(this,t,e)},t.prototype.style=function(t,e){return void 0===e&&(e=null),new w(this,t,e)},t.prototype.hasClass=function(t){var e=!1;return this.eachElem((function(r){if(e=r.classList.contains(t))return!1})),e},t.prototype.addClass=function(t){return this.eachElem((function(e){return e.classList.add(t)})),this},t.prototype.removeClass=function(t){return this.eachElem((function(e){return e.classList.remove(t)})),this},t.prototype.isMultipartCandidate=function(t){void 0===t&&(t=!1);var e="input[type='file']";return this.matchesSelector(e)||(t?this.querySelectorAllDeep(e):this.querySelectorAll(e)).first().isPresent()},t.prototype.html=function(t){return h.Optional.fromNullable(t).isAbsent()?this.isPresent()?h.Optional.fromNullable(this.innerHTML):h.Optional.absent:(this.innerHTML=t,this)},t.prototype.dispatchEvent=function(t){return this.eachElem((function(e){return e.dispatchEvent(t)})),this},Object.defineProperty(t.prototype,"innerHTML",{get:function(){var t=[];return this.eachElem((function(e){return t.push(e.innerHTML)})),t.join("")},set:function(t){this.eachElem((function(e){return e.innerHTML=t}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"innerHtml",{get:function(){return this.innerHTML},set:function(t){this.innerHTML=t},enumerable:!1,configurable:!0}),t.prototype._mozMatchesSelector=function(t,e){var r=t;return(r.matches||r.matchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector||r.webkitMatchesSelector||function(e){for(var r=(document||ownerDocument).querySelectorAll(e),n=r.length;--n>=0&&r.item(n)!==t;);return n>-1}).call(t,e)},t.prototype.filterSelector=function(e){var r=this,n=[];return this.eachElem((function(t){r._mozMatchesSelector(t,e)&&n.push(t)})),new(t.bind.apply(t,s([void 0],l(n),!1)))},t.prototype.matchesSelector=function(t){var e=this;return this.lazyStream.map((function(r){return e._mozMatchesSelector(r.getAsElem(0).value,t)})).filter((function(t){return t})).first().isPresent()},t.prototype.getIf=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this.childNodes,n=0;n<t.length;n++)if((r=r.filterSelector(t[n])).isAbsent())return r;return r},t.prototype.eachElem=function(t){for(var e=0,r=this.rootNode.length;e<r&&!1!==t(this.rootNode[e],e);e++);return this},t.prototype.firstElem=function(t){return void 0===t&&(t=function(t){return t}),this.rootNode.length>1&&t(this.rootNode[0],0),this},t.prototype.lastElem=function(t){return void 0===t&&(t=function(t){return t}),this.rootNode.length>1&&t(this.rootNode[this.rootNode.length-1],0),this},t.prototype.each=function(e){return f.Stream.of.apply(f.Stream,s([],l(this.rootNode),!1)).each((function(r,n){if(null!=r)return e(t.byId(r),n)})),this},t.prototype.first=function(t){return void 0===t&&(t=function(t){return t}),this.rootNode.length>=1?(t(this.get(0),0),this.get(0)):this},t.prototype.last=function(t){if(void 0===t&&(t=function(t){return t}),this.rootNode.length>=1){var e=this.get(this.rootNode.length-1);return t(e,0),e}return this},t.prototype.filter=function(e){var r=[];return this.each((function(t){e(t)&&r.push(t)})),new(t.bind.apply(t,s([void 0],l(r),!1)))},t.prototype.globalEval=function(t,e){var r=document.getElementsByTagName("head")[0]||document.documentElement,n=document.createElement("script");e&&(void 0!==(null==n?void 0:n.nonce)?n.nonce=e:n.setAttribute("nonce",e)),n.type="text/javascript",n.innerHTML=t;var o=r.appendChild(n);return r.removeChild(o),this},t.prototype.globalEvalSticky=function(t,e){var r=document.getElementsByTagName("head")[0]||document.documentElement,n=document.createElement("script");return e&&(void 0!==(null==n?void 0:n.nonce)?n.nonce=e:n.setAttribute("nonce",e)),n.type="text/javascript",n.innerHTML=t,r.appendChild(n),this},t.prototype.detach=function(){return this.eachElem((function(t){t.parentNode.removeChild(t)})),this},t.prototype.appendTo=function(e){return y.Lang.isString(e)?(this.appendTo(t.querySelectorAll(e)),this):(this.eachElem((function(t){e.getAsElem(0).orElseLazy((function(){return{appendChild:function(){}}})).value.appendChild(t)})),this)},t.prototype.loadScriptEval=function(t,e,r,n){void 0===e&&(e=0),void 0===r&&(r="utf-8");var o=this.createSourceNode(t,n),i=document.head;return e?setTimeout((function(){i.appendChild(o),i.removeChild(o)}),e):(i.appendChild(o),i.removeChild(o)),this},t.prototype.loadScriptEvalSticky=function(t,e,r,n){void 0===e&&(e=0),void 0===r&&(r="utf-8");var o=this.createSourceNode(t,n);return e?setTimeout((function(){document.head.appendChild(o)}),e):document.head.appendChild(o),this},t.prototype.insertAfter=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.each((function(t){for(var r=t.getAsElem(0).value,n=r.parentNode,o=function(t){var o=r.nextSibling;e[t].eachElem((function(t){o?(n.insertBefore(t,o),r=o):n.appendChild(t)}))},i=0;i<e.length;i++)o(i)}));var n=[];return n.push(this),n=n.concat(e),new(t.bind.apply(t,s([void 0],l(n),!1)))},t.prototype.insertBefore=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.each((function(t){for(var r=t.getAsElem(0).value,n=r.parentNode,o=0;o<e.length;o++)e[o].eachElem((function(t){n.insertBefore(t,r)}))}));var n=[];return n.push(this),n=n.concat(e),new(t.bind.apply(t,s([void 0],l(n),!1)))},t.prototype.orElse=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return this.isPresent()?this:new(t.bind.apply(t,s([void 0],l(e),!1)))},t.prototype.orElseLazy=function(e){return this.isPresent()?this:new t(e())},t.prototype.parents=function(e){var r=new Set,n=[],o=e.toLowerCase(),i=function(t){(t.tagName||"").toLowerCase()!=o||r.has(t)||(r.add(t),n.push(t))};return this.eachElem((function(t){for(var r;t.parentNode||t.host;)if(t=null!==(r=null==t?void 0:t.parentNode)&&void 0!==r?r:null==t?void 0:t.host,i(t),"form"==e&&n.length)return!1})),new(t.bind.apply(t,s([void 0],l(n),!1)))},t.prototype.copyAttrs=function(t){var e=this;return t.eachElem((function(t){var r,n,o=m(t.attributes);try{for(var i=c(o),a=i.next();!a.done;a=i.next()){var u=a.value,l=u.value,s=u.name;switch(s){case"id":e.id.value=l;break;case"disabled":e.resolveAttributeHolder("disabled").disabled=l;break;case"checked":e.resolveAttributeHolder("checked").checked=l;break;default:e.attr(s).value=l}}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}})),this},t.prototype.resolveAttributeHolder=function(t){void 0===t&&(t="value");var e=[];return e[t]=null,t in this.getAsElem(0).value?this.getAsElem(0).value:e},t.prototype.outerHTML=function(e,r,n,o){var i;if(void 0===o&&(o=!1),!this.isAbsent()){var a=null===(i=null===document||void 0===document?void 0:document.activeElement)||void 0===i?void 0:i.id,u=a?t.getCaretPosition(document.activeElement):null,c=t.fromMarkup(e),p=[],h=this.getAsElem(0).value,f=c.get(0),d=h.parentNode,y=f.getAsElem(0).value;if(d.replaceChild(y,h),p.push(new t(y)),this.isAbsent())return this;var v=[];c.length>1&&(v=v.concat.apply(v,s([],l(c.values.slice(1)),!1)),p.push(t.byId(y).insertAfter(new(t.bind.apply(t,s([void 0],l(v),!1)))))),r&&this.runScripts(),n&&this.runCss();var m=t.byId(a);return a&&m.isPresent()&&null!=u&&void 0!==u&&m.eachElem((function(e){return t.setCaretPosition(e,u)})),c}},t.prototype.runScripts=function(e,r){var n=this;void 0===e&&(e=!1),void 0===r&&(r=A);var o=function(t){if(t.length){var r=[];f.Stream.of.apply(f.Stream,s([],l(t),!1)).each((function(t){t.nonce?(r.length&&(n.globalEval(r.join("\n")),r.length=0),e?n.globalEvalSticky(t.evalText,t.nonce):n.globalEval(t.evalText,t.nonce)):r.push(t.evalText)})),r.length&&(e?n.globalEvalSticky(r.join("\n")):n.globalEval(r.join("\n")),r.length=0),t=[]}return t},i=[],a=g,u=function(t){var u,l,s,c=t.tagName,p=t.type||"";if(c&&a(c,"script")&&(""===p||a(p,"text/javascript")||a(p,"javascript")||a(p,"text/ecmascript")||a(p,"ecmascript"))){var h=t.getAttribute("src");if(void 0!==h&&null!=h&&h.length>0){var f=null!==(u=null==t?void 0:t.nonce)&&void 0!==u?u:t.getAttribute("nonce").value;r(h)&&(i=o(i),e?f?n.loadScriptEvalSticky(h,0,"UTF-8",f):n.loadScriptEvalSticky(h,0,"UTF-8"):f?n.loadScriptEval(h,0,"UTF-8",f):n.loadScriptEval(h,0,"UTF-8"))}else{for(var d=v(t.text||t.innerText||t.innerHTML),y=!0;y;)y=!1,"\x3c!--"==d.substring(0,4)&&(d=d.substring(4),y=!0),"//\x3c!--"==d.substring(0,4)&&(d=d.substring(6),y=!0),"//<![CDATA["==d.substring(0,11)&&(d=d.substring(11),y=!0);f=null!==(s=null!==(l=null==t?void 0:t.nonce)&&void 0!==l?l:t.getAttribute("nonce").value)&&void 0!==s?s:"";i.push({nonce:f,evalText:d})}}};try{new t(this.filterSelector("script"),this.querySelectorAll("script")).stream.flatMap((function(t){return f.Stream.of(t.values)})).sort((function(t,e){return t.compareDocumentPosition(e)-3})).each((function(t){return u(t)})),o(i)}catch(t){console&&console.error&&console.error(t.message||t.description)}finally{u=null}return this},t.prototype.runCss=function(){var e=function(t,e){var r,n,o,i,a=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(a);var u=null!==(r=a.sheet)&&void 0!==r?r:a.styleSheet;a.setAttribute("rel",null!==(n=t.getAttribute("rel"))&&void 0!==n?n:"stylesheet"),a.setAttribute("type",null!==(o=t.getAttribute("type"))&&void 0!==o?o:"text/css"),null!==(i=null==u?void 0:u.cssText)&&void 0!==i&&i?u.cssText=e:a.appendChild(document.createTextNode(e))};return new t(this.filterSelector("link, style"),this.querySelectorAll("link, style")).stream.flatMap((function(t){return f.Stream.of(t.values)})).sort((function(t,e){return t.compareDocumentPosition(e)-3})).each((function(t){return function(t){var r=t.tagName;if(r&&g(r,"link")&&g(t.getAttribute("type"),"text/css"))e(t,"@import url('"+t.getAttribute("href")+"');");else if(r&&g(r,"style")&&g(t.getAttribute("type"),"text/css")){var n=[],o=Array.prototype.slice.call(t.childNodes);o?o.forEach((function(t){return n.push(t.innerHTML||t.data)})):t.innerHTML&&n.push(t.innerHTML),e(t,n.join(""))}}(t)})),this},t.prototype.click=function(){return this.fireEvent("click"),this},t.prototype.addEventListener=function(t,e,r){return this.eachElem((function(n){return n.addEventListener(t,e,r)})),this},t.prototype.removeEventListener=function(t,e,r){return this.eachElem((function(n){return n.removeEventListener(t,e,r)})),this},t.prototype.fireEvent=function(t){this.eachElem((function(e){var r;if(e.ownerDocument)r=e.ownerDocument;else{if(9!=e.nodeType)throw new Error("Invalid node passed to fireEvent: "+e.id);r=e}if(e.dispatchEvent){var n="";switch(t){case"click":case"mousedown":case"mouseup":n="MouseEvents";break;case"focus":case"change":case"blur":case"select":n="HTMLEvents";break;default:throw"fireEvent: Couldn't find an event class for event '"+t+"'."}var o=r.createEvent(n);o.initEvent(t,!0,!0),o.synthetic=!0,e.dispatchEvent(o)}else if(e.fireEvent){var i=r.createEventObject();i.synthetic=!0,e.fireEvent("on"+t,i)}}))},t.prototype.textContent=function(t){return void 0===t&&(t=""),this.stream.map((function(t){return t.getAsElem(0).orElseLazy((function(){return{textContent:""}})).value.textContent||""})).reduce((function(e,r){return e+t+r}),"").value},t.prototype.innerText=function(t){return void 0===t&&(t=""),this.stream.map((function(t){return t.getAsElem(0).orElseLazy((function(){return{innerText:""}})).value.innerText||""})).reduce((function(e,r){return[e,r].join(t)}),"").value},t.prototype.encodeFormElement=function(t){if(void 0===t&&(t=new h.Config({})),!this.name.isAbsent()){var e=t.shallowCopy;return this.each((function(t){var r,n;if(!t.name.isAbsent()){var o=t.name.value,i=t.tagName.orElse("__none__").value.toLowerCase(),a=t.type.orElse("__none__").value.toLowerCase();if(a=a.toLowerCase(),("input"==i||"textarea"==i||"select"==i)&&null!=o&&""!=o&&!t.disabled){if("select"==i){var u=t.getAsElem(0).value;if(u.selectedIndex>=0)for(var l=u.options.length,s=0;s<l;s++)if(u.options[s].selected){var c=u.options[s];e.append(o).value=null!=c.getAttribute("value")?c.value:c.text}}if(i!=p.SELECT&&a!=p.BUTTON&&a!=p.RESET&&a!=p.SUBMIT&&a!=p.IMAGE&&(a!=p.CHECKBOX&&a!=p.RADIO||t.checked)){var h=null!==(n=null===(r=t.value.value)||void 0===r?void 0:r.files)&&void 0!==n?n:[];(null==h?void 0:h.length)?e.append(o).value=h[0]:e.append(o).value=t.inputValue.value}}}})),e}},Object.defineProperty(t.prototype,"cDATAAsString",{get:function(){return this.lazyStream.flatMap((function(t){return t.childNodes.stream})).filter((function(t){var e,r;return 4==(null===(r=null===(e=null==t?void 0:t.value)||void 0===e?void 0:e.value)||void 0===r?void 0:r.nodeType)})).reduce((function(t,e){var r,n,o;return t.push(null!==(o=null===(n=null===(r=null==e?void 0:e.value)||void 0===r?void 0:r.value)||void 0===n?void 0:n.data)&&void 0!==o?o:""),t}),[]).value.join("")},enumerable:!1,configurable:!0}),t.prototype.subNodes=function(e,r){return h.Optional.fromNullable(r).isAbsent()&&(r=this.length),new(t.bind.apply(t,s([void 0],l(this.rootNode.slice(e,Math.min(r,this.length))),!1)))},t.prototype.limits=function(t){return this._limits=t,this},t.prototype.hasNext=function(){var t=-1!=this._limits&&this.pos>=this._limits-1,e=this.pos>=this.values.length-1;return!(t||e)},t.prototype.next=function(){return this.hasNext()?(this.pos++,new t(this.values[this.pos])):null},t.prototype.lookAhead=function(e){return void 0===e&&(e=1),this.values.length-1<this.pos+e?d.ITERATION_STATUS.EO_STRM:new t(this.values[this.pos+e])},t.prototype.current=function(){return-1==this.pos?d.ITERATION_STATUS.BEF_STRM:new t(this.values[this.pos])},t.prototype.reset=function(){this.pos=-1},t.prototype.attachShadow=function(e){void 0===e&&(e={mode:"open"});var r=[];return this.eachElem((function(n){var o;if(!(null==n?void 0:n.attachShadow))throw new Error("Shadow dom creation not supported by the browser, please use a shim, to gain this functionality");o=t.byId(n.attachShadow(e)),r.push(o)})),new(t.bind.apply(t,s([void 0],l(r),!1)))},t.prototype.waitUntilDom=function(t,e){return void 0===e&&(e={attributes:!0,childList:!0,subtree:!0,timeout:500,interval:100}),a(this,void 0,void 0,(function(){return u(this,(function(r){return[2,_(this,t,e)]}))}))},Object.defineProperty(t.prototype,"shadowElements",{get:function(){var e=(this.querySelectorAll("*").filter((function(t){return t.hasShadow})).allElems()||[]).map((function(t){return t.shadowRoot}));return new(t.bind.apply(t,s([void 0],l(e),!1)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shadowRoot",{get:function(){for(var e=[],r=0;r<this.rootNode.length;r++)this.rootNode[r].shadowRoot&&e.push(this.rootNode[r].shadowRoot);return new(t.bind.apply(t,s([void 0],l(e),!1)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasShadow",{get:function(){for(var t=0;t<this.rootNode.length;t++)if(this.rootNode[t].shadowRoot)return!0;return!1},enumerable:!1,configurable:!0}),t.getCaretPosition=function(t){var e=0;try{if(null===document||void 0===document?void 0:document.selection){t.focus();var r=document.selection.createRange();r.moveStart("character",-t.value.length),e=r.text.length}}catch(t){}return e},t.setCaretPosition=function(t,e){(null==t?void 0:t.focus)&&(null==t||t.focus()),(null==t?void 0:t.setSelectiongRange)&&(null==t||t.setSelectiongRange(e,e))},t.prototype[Symbol.iterator]=function(){var t=this;return{next:function(){return{done:!t.hasNext(),value:t.next()}}}},t.prototype.concat=function(t,e){void 0===e&&(e=!0);var r=this.lazyStream.concat(t.lazyStream).collect(new C);if(!e)return r;var n={};return r.lazyStream.filter((function(t){var e=!(null==n?void 0:n[t.value.value.outerHTML]);return n[t.value.value.outerHTML]=!0,e})).collect(new C)},t.prototype.append=function(t){return this.each((function(e){return t.appendTo(e)})),this},t.prototype.prependTo=function(t){var e=this;return t.eachElem((function(t){t.prepend.apply(t,s([],l(e.allElems()),!1))})),this},t.prototype.prepend=function(t){return this.eachElem((function(e){e.prepend.apply(e,s([],l(t.allElems()),!1))})),this},t.prototype.createSourceNode=function(t,e){var r=document.createElement("script");return r.type="text/javascript",e&&(void 0!==(null==r?void 0:r.nonce)?r.nonce=e:r.setAttribute("nonce",e)),r.src=t,r},t.absent=new t,t.global=S._global$,t}();e.DomQuery=O;var C=function(){function t(){this.data=[]}return t.prototype.collect=function(t){this.data.push(t)},Object.defineProperty(t.prototype,"finalValue",{get:function(){return new(O.bind.apply(O,s([void 0],l(this.data),!1)))},enumerable:!1,configurable:!0}),t}();e.DomQueryCollector=C,e.DQ=O,e.DQ$=O.querySelectorAll},456:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e._global$=void 0,e._global$=function(){var t,e="undefined"!=typeof globalThis&&globalThis.window?globalThis.window:"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:void 0!==r.g&&(null===r.g||void 0===r.g?void 0:r.g.window)?r.g.window:void 0!==r.g?r.g:null;return null!==(t=null==e?void 0:e.window)&&void 0!==t?t:e}},805:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.Lang=void 0;var n=r(152);!function(t){function e(t){for(var e=/\s/,r=(t=t.replace(/^\s\s*/,"")).length;e.test(t.charAt(--r)););return t.slice(0,r+1)}function r(t){return!!arguments.length&&null!=t&&("string"==typeof t||t instanceof String)}t.saveResolve=function(t,e){void 0===e&&(e=null);try{var r=t();return n.Optional.fromNullable(null!=r?r:e)}catch(t){return n.Optional.absent}},t.saveResolveLazy=function(t,e){void 0===e&&(e=null);try{var r=t();return n.Optional.fromNullable(null!=r?r:e())}catch(t){return n.Optional.absent}},t.strToArray=function(t,r){void 0===r&&(r=/\./gi);var n=[];return t.split(r).forEach((function(t){n.push(e(t))})),n},t.trim=e,t.objToArray=function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=[]),"__undefined__"==(null!=t?t:"__undefined__")?null!=r?r:null:t instanceof Array&&!e&&!r?t:r.concat(Array.prototype.slice.call(t,e))},t.equalsIgnoreCase=function(t,e){var r=null!=e?e:"___no_value__";return(null!=t?t:"___no_value__").toLowerCase()===r.toLowerCase()},t.assertType=function(t,e){return r(e)?typeof t==e:t instanceof e},t.isString=r,t.isFunc=function(t){return t instanceof Function||"function"==typeof t},t.objAssign=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(null==t)throw new TypeError("Cannot convert undefined or null to object");var n=Object(t);return Object.assign?(e.forEach((function(t){return Object.assign(n,t)})),n):(e.filter((function(t){return null!=t})).forEach((function(t){var e=t;Object.keys(e).filter((function(t){return Object.prototype.hasOwnProperty.call(e,t)})).forEach((function(t){return n[t]=e[t]}))})),n)}}(e.Lang||(e.Lang={}))},493:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.BrokerBuilder=e.Broker=e.BroadcastChannelBrokerBuilder=e.BroadcastChannelBroker=e.Message=e.NoCrypto=void 0;var u=r(832),l=r(551),s=r(456),c=function(){function t(){}return t.prototype.decode=function(t){return t},t.prototype.encode=function(t){return t},t}();e.NoCrypto=c;var p=new c,h=function(t,e){void 0===t&&(t={}),void 0===e&&(e="*"),this.message=t,this.encoded=!1,this.targetOrigin=e,this.creationDate=(new Date).getMilliseconds(),this.identifier=(new Date).getMilliseconds()+"_"+Math.random()+"_"+Math.random()};e.Message=h;var f=function(t,e){this.detail=e,this.bubbles=!0,this.cancelable=!0,this.composed=!0,this.channel=t},d=function(){function t(){this.messageListeners={},this.subjects={},this.processedMessages={},this.cleanupCnt=0,this.TIMEOUT_IN_MS=1e3,this.MSG_EVENT="message",this.crypto=p}return t.prototype.registerListener=function(t,e){var r=this;return this.reserveListenerNS(t),this.messageListeners[t].push((function(t){var n;t.identifier in r.processedMessages||(((null==t?void 0:t.encoded)||(null===(n=null==t?void 0:t.detail)||void 0===n?void 0:n.encoded))&&((null==t?void 0:t.detail)?(t.detail.message=r.crypto.decode(t.detail.message),t.detail.encoded=!1):(t.message=r.crypto.decode(t.message),t.encoded=!1)),e(t))})),this},t.prototype.asSubject=function(t){var e=this;this.reserveSubjectNS(t);var r=this.subjects[t],n=r.next;return r.next=function(o){(null==o?void 0:o.detail)?n.call(r,null==o?void 0:o.detail):e.broadcast(t,o)},r},t.prototype.asObservable=function(t){return this.asSubject(t).asObservable()},t.prototype.reserveListenerNS=function(t){this.messageListeners[t]||(this.messageListeners[t]=[]),this.messageListeners["*"]||(this.messageListeners["*"]=[])},t.prototype.reserveSubjectNS=function(t){this.subjects[t]||(this.subjects[t]=new u.Subject),this.subjects["*"]||(this.subjects["*"]=new u.Subject)},t.prototype.unregisterListener=function(t,e){return this.messageListeners[t]=(this.messageListeners[t]||[]).filter((function(t){return t!==e})),this},t.prototype.answer=function(e,r,n){if("string"==typeof r&&(r=new h(r)),!t.isAnswer(r))return n.identifier=t.getAnswerId(r),this.broadcast(e,n),this},t.getAnswerId=function(t){return"_r_"+t.identifier},t.isAnswer=function(t){return 0==t.identifier.indexOf("_r_")},t.prototype.request=function(t,e){var r=this;"string"==typeof e&&(e=new h(e));var n=e.identifier,o=new Promise((function(e,o){var i=null,a=function(o){o.identifier!=n&&o.identifier=="_r_"+n&&(clearTimeout(i),r.unregisterListener(t,a),e(o))};i=setTimeout((function(){r.unregisterListener(t,a),o("request message performed, timeout, no return value")}),3e3),r.registerListener(t,a)}));return this.broadcast(t,e),o},t.prototype.gcProcessedMessages=function(){var t=this;if(++this.cleanupCnt%10==0){var e={};Object.keys(this.processedMessages).forEach((function(r){t.messageStillActive(r)||(e[r]=t.processedMessages[r])})),this.processedMessages=e}},t.prototype.messageStillActive=function(t){return this.processedMessages[t]>(new Date).getMilliseconds()-this.TIMEOUT_IN_MS},t.prototype.markMessageAsProcessed=function(t){this.processedMessages[t.identifier]=t.creationDate},t.EVENT_TYPE="brokerEvent",t}(),y=function(t){var e;if(null===(e=(0,s._global$)())||void 0===e?void 0:e.BroadcastChannel)return new((0,s._global$)().BroadcastChannel)(t);throw Error("No Broadcast channel in the system, use a shim or provide a factory functionin the constructor")},v="brokr",m=function(t){function e(e,r,n){void 0===e&&(e=y),void 0===r&&(r=v),void 0===n&&(n=p);var o=t.call(this)||this;return o.brokerFactory=e,o.channelGroup=r,o.crypto=n,o.openChannels={},o.msgListener=function(t){var e,r;t.detail.encoded&&(t.detail.message=o.crypto.decode(t.detail.message),t.detail.encoded=!1);var n=t.detail,i=t.channel;return(null===(e=o.messageListeners)||void 0===e?void 0:e[i])&&(null===(r=o.messageListeners)||void 0===r||r[i].forEach((function(t){t(n)}))),o.markMessageAsProcessed(n),!0},o.crypto=n,o.register(),o}return o(e,t),e.prototype.broadcast=function(t,e,r){void 0===r&&(r=!0);try{"string"==typeof e&&(e=new h(e));var n=JSON.stringify(e);e=JSON.parse(n);var o=new f(t,e);o.detail.message=this.crypto.encode(o.detail.message),o.detail.encoded=!0,(null==this?void 0:this.subjects[t])&&this.subjects[t].next(o),this.openChannels[this.channelGroup].postMessage(o),r&&this.msgListener(o)}finally{this.gcProcessedMessages()}return this},e.prototype.registerListener=function(e,r){return t.prototype.registerListener.call(this,e,r),this},e.prototype.register=function(){return this.openChannels[this.channelGroup]||(this.openChannels[this.channelGroup]=this.brokerFactory(this.channelGroup)),this.openChannels[this.channelGroup].addEventListener("message",this.msgListener),this},e.prototype.unregister=function(){return this.openChannels[this.channelGroup].close(),this},e}(d);e.BroadcastChannelBroker=m;var b=function(){function t(){this.broadCastChannelGenerator=y,this.channelGroup=v,this.crypto=p,this.listeners=[]}return t.prototype.withGeneratorFunc=function(t){return this.broadCastChannelGenerator=t,this},t.prototype.withListener=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return l.Stream.of.apply(l.Stream,a([],i(r),!1)).each((function(r){e.listeners.push({channel:t,listener:r})})),this},t.prototype.withChannelGroup=function(t){return this.channelGroup=t,this},t.prototype.withCrypto=function(t){return this.crypto=t,this},t.prototype.build=function(){var t=new m(this.broadCastChannelGenerator,this.channelGroup,this.crypto);return l.Stream.of.apply(l.Stream,a([],i(this.listeners),!1)).each((function(e){t.registerListener(e.channel,e.listener)})),t},t}();e.BroadcastChannelBrokerBuilder=b;var g=function(t){function e(e,r,n){void 0===e&&(e=window),void 0===r&&(r="brokr"),void 0===n&&(n=p);var o=t.call(this)||this;o.brokerGroup=r;return o.msgHandler=function(t){return function(t){var e,r,n,i,a=null!==(e=null==t?void 0:t.detail)&&void 0!==e?e:null===(r=null==t?void 0:t.data)||void 0===r?void 0:r.detail,u=null!==(i=null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.channel)&&void 0!==i?i:null==t?void 0:t.channel;if((null==a?void 0:a.identifier)&&(null==a?void 0:a.message)){var l=a;if(l.identifier in o.processedMessages)return;null==t||t.detail,o.broadcast(u,l)}}(t)},o.crypto=n,o.register(e),o}return o(e,t),e.prototype.register=function(t){(this.rootElem=t.host?t.host:t,t.host)?t.host.setAttribute("data-broker","1"):(null==t?void 0:t.setAttribute)&&t.setAttribute("data-broker","1");return this.rootElem.addEventListener(this.brokerGroup+"__||__"+e.EVENT_TYPE,this.msgHandler,{capture:!0}),this.rootElem.addEventListener(this.brokerGroup+"__||__"+e.EVENT_TYPE+this.MSG_EVENT,this.msgHandler,{capture:!0}),this},e.prototype.unregister=function(){return this.rootElem.removeEventListener(this.brokerGroup+"__||__"+e.EVENT_TYPE,this.msgHandler),this.rootElem.removeEventListener(this.brokerGroup+"__||__"+this.MSG_EVENT,this.msgHandler),this},e.prototype.broadcast=function(t,e){if("string"==typeof e&&(e=new h(e)),null==this?void 0:this.subjects[t]){var r=new f(t,e);r.detail.encoded||(r.detail.message=this.crypto.encode(r.detail.message),r.detail.encoded=!0),this.subjects[t].next(r)}try{this.dispatchUp(t,e,!1,!0),this.dispatchDown(t,e,!0,!1)}finally{this.gcProcessedMessages()}return this},e.prototype.dispatchUp=function(t,e,r,n){if(void 0===r&&(r=!0),void 0===n&&(n=!0),r||this.msgCallListeners(t,e),this.markMessageAsProcessed(e),null!=(0,s._global$)().parent){var o=new f(t,e);(0,s._global$)().parent.postMessage(JSON.parse(JSON.stringify(o)),e.targetOrigin)}n&&this.dispatchSameLevel(t,e)},e.prototype.dispatchSameLevel=function(t,e){var r=this.transformToEvent(t,e,!0);(0,s._global$)().dispatchEvent(r)},e.prototype.dispatchDown=function(t,e,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0),r||this.msgCallListeners(t,e),this.processedMessages[e.identifier]=e.creationDate;var o=this.transformToEvent(t,e);Array.prototype.slice.call(document.querySelectorAll("iframe")).forEach((function(r){var n=new f(t,e);r.contentWindow.postMessage(JSON.parse(JSON.stringify(n)),e.targetOrigin)})),Array.prototype.slice.call(document.querySelectorAll("[data-broker='1']")).forEach((function(t){return t.dispatchEvent(o)})),n&&this.dispatchSameLevel(t,e)},e.prototype.msgCallListeners=function(t,e){var r=this.messageListeners[t];if(null==r?void 0:r.length){r.forEach((function(t){t(e)}))}},e.prototype.transformToEvent=function(t,r,n){void 0===n&&(n=!1);var o=new f(t,r);return o.bubbles=n,e.createCustomEvent(this.brokerGroup+"__||__"+e.EVENT_TYPE,o)},e.createCustomEvent=function(t,e){if("function"!=typeof(0,s._global$)().CustomEvent){var r=document.createEvent("HTMLEvents");return r.detail=e.detail,r.channel=e.channel,r.initEvent(t,e.bubbles,e.cancelable),r}var n=new((0,s._global$)().CustomEvent)(t,e);return n.channel=e.channel,n},e}(d);e.Broker=g;var S=function(){function t(){this.scopeElement=window,this.channelGroup=v,this.crypto=p,this.listeners=[]}return t.prototype.withScopeElement=function(t){return this.scopeElement=t,this},t.prototype.withListener=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return l.Stream.of.apply(l.Stream,a([],i(r),!1)).each((function(r){e.listeners.push({channel:t,listener:r})})),this},t.prototype.withChannelGroup=function(t){return this.channelGroup=t,this},t.prototype.withCrypto=function(t){return this.crypto=t,this},t.prototype.build=function(){var t=new g(this.scopeElement,this.channelGroup,this.crypto);return l.Stream.of.apply(l.Stream,a([],i(this.listeners),!1)).each((function(e){t.registerListener(e.channel,e.listener)})),t},t}();e.BrokerBuilder=S},152:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.Config=e.ValueEmbedder=e.Optional=e.Monad=void 0;var u=r(805),l=r(255),s=r(551),c=u.Lang.objAssign,p=function(){function t(t){this._value=t}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),t.prototype.map=function(e){return e||(e=function(t){return t}),new t(e(this.value))},t.prototype.flatMap=function(e){for(var r=this.map(e);(null==r?void 0:r.value)instanceof t;)r=r.value;return r},t}();e.Monad=p;var h=function(t){function e(e){return t.call(this,e)||this}return o(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value instanceof p?this._value.flatMap().value:this._value},enumerable:!1,configurable:!0}),e.fromNullable=function(t){return new e(t)},e.prototype.isAbsent=function(){return void 0===this.value||null==this.value},e.prototype.isPresent=function(t){var e=this.isAbsent();return!e&&t&&t.call(this,this),!e},e.prototype.ifPresentLazy=function(t){return void 0===t&&(t=function(){}),this.isPresent.call(this,t),this},e.prototype.orElse=function(t){return this.isPresent()?this:null==t?e.absent:this.flatMap((function(){return t}))},e.prototype.orElseLazy=function(t){return this.isPresent()?this:this.flatMap(t)},e.prototype.flatMap=function(r){var n=t.prototype.flatMap.call(this,r);return n instanceof e?n.flatMap():e.fromNullable(n.value)},e.prototype.getIf=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this,n=0;n<t.length;n++){var o=this.keyVal(t[n]),i=this.arrayIndex(t[n]);if(""===o&&i>=0){if((r=this.getClass().fromNullable(r.value instanceof Array?r.value.length<i?null:r.value[i]:null)).isAbsent())return r}else if(o&&i>=0){if(r.getIfPresent(o).isAbsent())return r;if((r=r.getIfPresent(o).value instanceof Array?this.getClass().fromNullable(r.getIfPresent(o).value[i]):this.getClass().absent).isAbsent())return r}else{if((r=r.getIfPresent(o)).isAbsent())return r;i>-1&&(r=this.getClass().fromNullable(r.value[i]))}}return r},e.prototype.match=function(t){return!this.isAbsent()&&t(this.value)},e.prototype.get=function(t){return void 0===t&&(t=e.absent),this.isAbsent()?this.getClass().fromNullable(t).flatMap():this.getClass().fromNullable(this.value).flatMap()},e.prototype.toJson=function(){return JSON.stringify(this.value)},e.prototype.getClass=function(){return e},e.prototype.arrayIndex=function(t){var e=t.indexOf("["),r=t.indexOf("]");return e>=0&&r>0&&e<r?parseInt(t.substring(e+1,r)):-1},e.prototype.keyVal=function(t){var e=t.indexOf("[");return e>=0?t.substring(0,e):t},e.prototype.getIfPresent=function(t){return this.isAbsent()?this.getClass().absent:this.getClass().fromNullable(this.value[t]).flatMap()},e.prototype.resolve=function(t){if(this.isAbsent())return e.absent;try{return e.fromNullable(t(this.value))}catch(t){return e.absent}},e.absent=e.fromNullable(null),e}(p);e.Optional=h;var f=function(t){function e(e,r){void 0===r&&(r="value");var n=t.call(this,e)||this;return n.key=r,n}return o(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value?this._value[this.key]:null},set:function(t){this._value&&(this._value[this.key]=t)},enumerable:!1,configurable:!0}),e.prototype.orElse=function(t){var r={};return r[this.key]=t,this.isPresent()?this:new e(r,this.key)},e.prototype.orElseLazy=function(t){if(this.isPresent())return this;var r={};return r[this.key]=t(),new e(r,this.key)},e.prototype.getClass=function(){return e},e.fromNullable=function(t,r){return void 0===r&&(r="value"),new e(t,r)},e.absent=e.fromNullable(null),e}(h);e.ValueEmbedder=f;var d=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o.arrPos=null!=n?n:-1,o}return o(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return""==this.key&&this.arrPos>=0?this._value[this.arrPos]:this.key&&this.arrPos>=0?this._value[this.key][this.arrPos]:this._value[this.key]},set:function(t){""==this.key&&this.arrPos>=0?this._value[this.arrPos]=t:this.key&&this.arrPos>=0?this._value[this.key][this.arrPos]=t:this._value[this.key]=t},enumerable:!1,configurable:!0}),e.absent=e.fromNullable(null),e}(f),y=function(t){function e(e){return t.call(this,e)||this}return o(e,t),Object.defineProperty(e.prototype,"shallowCopy",{get:function(){return this.shallowCopy$()},enumerable:!1,configurable:!0}),e.prototype.shallowCopy$=function(){return new e(s.Stream.ofAssoc(this.value).collect(new l.AssocArrayCollector))},Object.defineProperty(e.prototype,"deepCopy",{get:function(){return this.deepCopy$()},enumerable:!1,configurable:!0}),e.prototype.deepCopy$=function(){return new e(c({},this.value))},e.fromNullable=function(t){return new e(t)},e.prototype.shallowMerge=function(t,e,r){var n=this;void 0===e&&(e=!0),void 0===r&&(r=!1);var o=function(o){!e&&o in u.value||(r?Array.isArray(t.getIf(o).value)?s.Stream.of.apply(s.Stream,a([],i(t.getIf(o).value),!1)).each((function(t){return n.append(o).value=t})):u.append(o).value=t.getIf(o).value:u.assign(o).value=t.getIf(o).value)},u=this;for(var l in t.value)o(l)},e.prototype.append=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t.length<1;if(!r){var n=t[t.length-1],o=(this.keyVal(n),this.getIf.apply(this,a([],i(t),!1)).isPresent());this.buildPath(t);var u=this.arrayIndex(n);if(u>-1)throw Error("Append only possible on non array properties, use assign on indexed data");var l=this.getIf.apply(this,a([],i(t),!1)).value;Array.isArray(l)||(l=this.assign.apply(this,a([],i(t),!1)).value=[l]),o&&l.push({}),u=l.length-1;var s=new d(1==t.length?this.value:this.getIf.apply(this,t.slice(0,t.length-1)).value,n,u);return s}},e.prototype.appendIf=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return t?this.append.apply(this,a([],i(e),!1)):{value:null}},e.prototype.assign=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!(t.length<1)){this.buildPath(t);var r=this.keyVal(t[t.length-1]),n=this.arrayIndex(t[t.length-1]),o=new d(1==t.length?this.value:this.getIf.apply(this,t.slice(0,t.length-1)).value,r,n);return o}},e.prototype.assignIf=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return t?this.assign.apply(this,a([],i(e),!1)):{value:null}},e.prototype.getIf=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return this.getClass().fromNullable(t.prototype.getIf.apply(this,e).value)},e.prototype.get=function(e){return this.getClass().fromNullable(t.prototype.get.call(this,e).value)},e.prototype.delete=function(t){return t in this.value&&delete this.value[t],this},e.prototype.toJson=function(){return JSON.stringify(this.value)},e.prototype.getClass=function(){return e},e.prototype.setVal=function(t){this._value=t},e.prototype.buildPath=function(t){for(var e=this,r=this.getClass().fromNullable(null),n=-1,o=function(t,e){for(var r=t.length,n=r+e,o=r;o<n;o++)t.push({})},i=0;i<t.length;i++){var a=this.keyVal(t[i]),u=this.arrayIndex(t[i]);if(""===a&&u>=0)e.setVal(e.value instanceof Array?e.value:[]),o(e.value,u+1),n>=0&&(r.value[n]=e.value),r=e,n=u,e=this.getClass().fromNullable(e.value[u]);else{var l=e.getIf(a);if(-1==u)l.isAbsent()?l=this.getClass().fromNullable(e.value[a]={}):e=l;else{var s=l.value instanceof Array?l.value:[];o(s,u+1),e.value[a]=s,l=this.getClass().fromNullable(s[u])}r=e,n=u,e=l}}return this},e}(h);e.Config=y},376:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.CancellablePromise=e.Promise=e.interval=e.timeout=e.PromiseStatus=void 0;var i,a=r(152);!function(t){t[t.PENDING=0]="PENDING",t[t.FULLFILLED=1]="FULLFILLED",t[t.REJECTED=2]="REJECTED"}(i=e.PromiseStatus||(e.PromiseStatus={})),e.timeout=function(t){var e=null;return new l((function(r,n){e=setTimeout((function(){return r()}),t)}),(function(){e&&(clearTimeout(e),e=null)}))},e.interval=function(t){var e=null;return new l((function(r,n){e=setInterval((function(){r()}),t)}),(function(){e&&(clearInterval(e),e=null)}))};var u=function(){function t(t){var e=this;this.status=i.PENDING,this.allFuncs=[],this.value=t,this.value((function(t){return e.resolve(t)}),(function(t){return e.reject(t)}))}return t.all=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n,o=0,i=new t((function(t,e){n=t})),a=function(){o++,e.length==o&&n()};a.__last__=!0;for(var u=0;u<e.length;u++)e[u].finally(a);return i},t.race=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n,o,i=new t((function(t,e){n=t,o=e})),a=function(){return n&&n(),n=null,o=null,null};a.__last__=!0;var u=function(){return o&&o(),o=null,n=null,null};u.__last__=!0;for(var l=0;l<e.length;l++)e[l].then(a),e[l].catch(u);return i},t.reject=function(e){return new t((function(r,n){e instanceof t?e.then((function(t){n(t)})):setTimeout((function(){n(e)}),1)}))},t.resolve=function(e){return new t((function(r,n){e instanceof t?e.then((function(t){return r(t)})):setTimeout((function(){r(e)}),1)}))},t.prototype.then=function(t,e){return this.allFuncs.push({then:t}),e&&this.allFuncs.push({catch:e}),this.spliceLastFuncs(),this},t.prototype.catch=function(t){return this.allFuncs.push({catch:t}),this.spliceLastFuncs(),this},t.prototype.finally=function(t){if(!this.__reason__)return this.allFuncs.push({finally:t}),this.spliceLastFuncs(),this;this.__reason__.finally(t)},t.prototype.resolve=function(e){for(;this.allFuncs.length&&this.allFuncs[0].then;){var r=this.allFuncs.shift(),n=a.Optional.fromNullable(r.then(e));if(!n.isPresent())break;if((e=(n=n.flatMap()).value)instanceof t)return void this.transferIntoNewPromise(e)}this.appyFinally(),this.status=i.FULLFILLED},t.prototype.reject=function(e){for(;this.allFuncs.length&&!this.allFuncs[0].finally;){var r=this.allFuncs.shift();if(r.catch){var n=a.Optional.fromNullable(r.catch(e));if(n.isPresent()){if((e=(n=n.flatMap()).value)instanceof t)return void this.transferIntoNewPromise(e);this.status=i.REJECTED;break}break}}this.status=i.REJECTED,this.appyFinally()},t.prototype.appyFinally=function(){for(;this.allFuncs.length;){var t=this.allFuncs.shift();t.finally&&t.finally()}},t.prototype.spliceLastFuncs=function(){for(var t=[],e=[],r=0;r<this.allFuncs.length;r++)for(var n in this.allFuncs[r])this.allFuncs[r][n].__last__?t.push(this.allFuncs[r]):e.push(this.allFuncs[r]);this.allFuncs=e.concat(t)},t.prototype.transferIntoNewPromise=function(t){for(var e=0;e<this.allFuncs.length;e++)for(var r in this.allFuncs[e])t[r](this.allFuncs[e][r])},t}();e.Promise=u;var l=function(t){function e(e,r){var n=t.call(this,e)||this;return n.cancellator=function(){},n.cancellator=r,n}return o(e,t),e.prototype.cancel=function(){this.status=i.REJECTED,this.appyFinally(),this.allFuncs=[]},e.prototype.then=function(e,r){return t.prototype.then.call(this,e,r)},e.prototype.catch=function(e){return t.prototype.catch.call(this,e)},e.prototype.finally=function(e){return t.prototype.finally.call(this,e)},e}(u);e.CancellablePromise=l},255:function(t,e,r){var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.QueryFormStringCollector=e.QueryFormDataCollector=e.FormDataCollector=e.AssocArrayCollector=e.Run=e.ArrayAssocArrayCollector=e.ArrayCollector=e.FlatMapStreamDataSource=e.MappedStreamDataSource=e.FilteredStreamDatasource=e.ArrayStreamDataSource=e.SequenceDataSource=e.ITERATION_STATUS=void 0;var i,a=r(551);!function(t){t.EO_STRM="__EO_STRM__",t.BEF_STRM="___BEF_STRM__"}(i=e.ITERATION_STATUS||(e.ITERATION_STATUS={}));var u=function(){function t(t,e){this.total=e,this.start=t,this.value=t-1}return t.prototype.hasNext=function(){return this.value<this.total-1},t.prototype.next=function(){return this.value++,this.value<=this.total-1?this.value:i.EO_STRM},t.prototype.lookAhead=function(t){return void 0===t&&(t=1),this.value+t>this.total-1?i.EO_STRM:this.value+t},t.prototype.reset=function(){this.value=this.start-1},t.prototype.current=function(){return this.start-1?i.BEF_STRM:this.value},t}();e.SequenceDataSource=u;var l=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.dataPos=-1,this.value=t}return t.prototype.lookAhead=function(t){return void 0===t&&(t=1),this.dataPos+t>this.value.length-1?i.EO_STRM:this.value[this.dataPos+t]},t.prototype.hasNext=function(){return this.value.length-1>this.dataPos},t.prototype.next=function(){var t;return this.dataPos++,null!==(t=null==this?void 0:this.value[this.dataPos])&&void 0!==t?t:i.EO_STRM},t.prototype.reset=function(){this.dataPos=-1},t.prototype.current=function(){return this.value[Math.max(0,this.dataPos)]},t}();e.ArrayStreamDataSource=l;var s=function(){function t(t,e){this._current=i.BEF_STRM,this._filterIdx={},this._unfilteredPos=0,this.filterFunc=t,this.inputDataSource=e}return t.prototype.hasNext=function(){for(var t,e=1,r=!1;!r&&(t=this.inputDataSource.lookAhead(e))!=i.EO_STRM;)this.filterFunc(t)?(this._filterIdx[this._unfilteredPos+e]=!0,r=!0):e++;return r},t.prototype.next=function(){for(var t,e,r=i.EO_STRM;this.inputDataSource.hasNext();){this._unfilteredPos++;var n=this.inputDataSource.next();if(n!=i.EO_STRM&&(null!==(e=null===(t=this._filterIdx)||void 0===t?void 0:t[this._unfilteredPos])&&void 0!==e&&e||this.filterFunc(n))){this._filterIdx[this._unfilteredPos]=!0,r=n;break}}return this._current=r,r},t.prototype.lookAhead=function(t){var e,r;void 0===t&&(t=1);for(var n=1;t>0&&(r=this.inputDataSource.lookAhead(n))!=i.EO_STRM;n++){((null===(e=this._filterIdx)||void 0===e?void 0:e[this._unfilteredPos+n])||this.filterFunc(r))&&(t--,this._filterIdx[this._unfilteredPos+n]=!0)}return r},t.prototype.current=function(){return this._current},t.prototype.reset=function(){this._current=i.BEF_STRM,this._filterIdx={},this._unfilteredPos=0,this.inputDataSource.reset()},t}();e.FilteredStreamDatasource=s;var c=function(){function t(t,e){this.mapFunc=t,this.inputDataSource=e}return t.prototype.hasNext=function(){return this.inputDataSource.hasNext()},t.prototype.next=function(){return this.mapFunc(this.inputDataSource.next())},t.prototype.reset=function(){this.inputDataSource.reset()},t.prototype.current=function(){return this.mapFunc(this.inputDataSource.current())},t.prototype.lookAhead=function(t){void 0===t&&(t=1);var e=this.inputDataSource.lookAhead(t);return e==i.EO_STRM?e:this.mapFunc(e)},t}();e.MappedStreamDataSource=c;var p=function(){function t(t,e){this.walkedDataSources=[],this._currPos=0,this.mapFunc=t,this.inputDataSource=e}return t.prototype.hasNext=function(){return this.resolveActiveHasNext()||this.resolveNextHasNext()},t.prototype.resolveActiveHasNext=function(){var t=!1;return this.activeDataSource&&(t=this.activeDataSource.hasNext()),t},t.prototype.lookAhead=function(t){var e;if(void 0===t&&(t=1),(null==this?void 0:this.activeDataSource)&&(null===(e=null==this?void 0:this.activeDataSource)||void 0===e?void 0:e.lookAhead(t))!=i.EO_STRM)return null==this?void 0:this.activeDataSource.lookAhead(t);function r(e){var r=e?function(t){for(var e=1;t.lookAhead(e)!==i.EO_STRM;)e++;return e-1}(e):0;t-=r}this.activeDataSource&&r(this.activeDataSource);for(var n=1;;n++){var o=this.inputDataSource.lookAhead(n);if(o===i.EO_STRM)return i.EO_STRM;var a=this.mapFunc(o),u=this.toDatasource(a).lookAhead(t);if(u!=i.EO_STRM)return u;r(o)}},t.prototype.toDatasource=function(t){var e=Array.isArray(t)?new(l.bind.apply(l,o([void 0],n(t),!1))):t;return this.walkedDataSources.push(e),e},t.prototype.resolveNextHasNext=function(){for(var t=!1;!t&&this.inputDataSource.hasNext();){var e=this.mapFunc(this.inputDataSource.next());this.activeDataSource=this.toDatasource(e),t=this.activeDataSource.hasNext()}return t},t.prototype.next=function(){if(this.hasNext())return this._currPos++,this.activeDataSource.next()},t.prototype.reset=function(){this.inputDataSource.reset(),this.walkedDataSources.forEach((function(t){return t.reset()})),this.walkedDataSources=[],this._currPos=0,this.activeDataSource=null},t.prototype.current=function(){return this.activeDataSource||this.hasNext(),this.activeDataSource.current()},t}();e.FlatMapStreamDataSource=p;var h=function(){function t(){this.data=[]}return t.prototype.collect=function(t){this.data.push(t)},Object.defineProperty(t.prototype,"finalValue",{get:function(){return this.data},enumerable:!1,configurable:!0}),t}();e.ArrayCollector=h;var f=function(){function t(){this.finalValue={}}return t.prototype.collect=function(t){var e,r,n,o,i=null!==(e=null==t?void 0:t[0])&&void 0!==e?e:t;this.finalValue[i]=null!==(n=null===(r=this.finalValue)||void 0===r?void 0:r[i])&&void 0!==n?n:[],this.finalValue[i].push(null===(o=null==t?void 0:t[1])||void 0===o||o)},t}();e.ArrayAssocArrayCollector=f;var d=function(){function t(){}return t.prototype.collect=function(t){},Object.defineProperty(t.prototype,"finalValue",{get:function(){return null},enumerable:!1,configurable:!0}),t}();e.Run=d;var y=function(){function t(){this.finalValue={}}return t.prototype.collect=function(t){var e,r;this.finalValue[null!==(e=t[0])&&void 0!==e?e:t]=null===(r=t[1])||void 0===r||r},t}();e.AssocArrayCollector=y;var v=function(){function t(){this.finalValue=new FormData}return t.prototype.collect=function(t){this.finalValue.append(t.key,t.value)},t}();e.FormDataCollector=v;var m=function(){function t(){this.finalValue=new FormData}return t.prototype.collect=function(t){var e=t.encodeFormElement();e.isPresent()&&this.finalValue.append(t.name.value,e.get(t.name).value)},t}();e.QueryFormDataCollector=m;var b=function(){function t(){this.formData=[]}return t.prototype.collect=function(t){var e=t.encodeFormElement();e.isPresent()&&this.formData.push([t.name.value,e.get(t.name).value])},Object.defineProperty(t.prototype,"finalValue",{get:function(){return a.Stream.of.apply(a.Stream,o([],n(this.formData),!1)).map((function(t){return t.join("=")})).reduce((function(t,e){return[t,e].join("&")})).orElse("").value},enumerable:!1,configurable:!0}),t}();e.QueryFormStringCollector=b},551:function(t,e,r){var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.LazyStream=e.Stream=void 0;var i=r(152),a=r(255),u=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._limits=-1,this.pos=-1,this.value=t}return t.of=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new(t.bind.apply(t,o([void 0],n(e),!1)))},t.ofAssoc=function(t){return this.of.apply(this,o([],n(Object.keys(t)),!1)).map((function(e){return[e,t[e]]}))},t.ofDataSource=function(e){for(var r=[];e.hasNext();)r.push(e.next());return new(t.bind.apply(t,o([void 0],n(r),!1)))},t.prototype.limits=function(t){return this._limits=t,this},t.prototype.concat=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.of.apply(t,o([this],n(e),!1)).flatMap((function(t){return t}))},t.prototype.onElem=function(t){for(var e=0;e<this.value.length&&(-1==this._limits||e<this._limits)&&!1!==t(this.value[e],e);e++);return this},t.prototype.each=function(t){this.onElem(t),this.reset()},t.prototype.map=function(e){e||(e=function(t){return t});var r=[];return this.each((function(t){r.push(e(t))})),new(t.bind.apply(t,o([void 0],n(r),!1)))},t.prototype.flatMap=function(e){var r=[];return this.each((function(t){var i=e(t);r=Array.isArray(i)?r.concat(i):r.concat.apply(r,o([],n(i.value),!1))})),t.of.apply(t,o([],n(r),!1))},t.prototype.filter=function(e){var r=[];return this.each((function(t){e(t)&&r.push(t)})),new(t.bind.apply(t,o([void 0],n(r),!1)))},t.prototype.reduce=function(t,e){void 0===e&&(e=null);for(var r=null!=e?0:1,n=null!=e?e:this.value.length?this.value[0]:null,o=r;o<this.value.length&&(-1==this._limits||o<this._limits);o++)n=t(n,this.value[o]);return this.reset(),i.Optional.fromNullable(n)},t.prototype.first=function(){return this.reset(),this.value&&this.value.length?i.Optional.fromNullable(this.value[0]):i.Optional.absent},t.prototype.last=function(){var t=this._limits>0?Math.min(this._limits,this.value.length):this.value.length;return this.reset(),i.Optional.fromNullable(t?this.value[t-1]:null)},t.prototype.anyMatch=function(t){for(var e=0;e<this.value.length&&(-1==this._limits||e<this._limits);e++)if(t(this.value[e]))return!0;return this.reset(),!1},t.prototype.allMatch=function(t){if(!this.value.length)return!1;for(var e=0,r=0;r<this.value.length;r++)t(this.value[r])&&e++;return this.reset(),e==this.value.length},t.prototype.noneMatch=function(t){for(var e=0,r=0;r<this.value.length;r++)t(this.value[r])||e++;return this.reset(),e==this.value.length},t.prototype.sort=function(e){var r=this.value.slice().sort(e);return t.of.apply(t,o([],n(r),!1))},t.prototype.collect=function(t){return this.each((function(e){return t.collect(e)})),this.reset(),t.finalValue},t.prototype.hasNext=function(){var t=-1!=this._limits&&this.pos>=this._limits-1,e=this.pos>=this.value.length-1;return!(t||e)},t.prototype.next=function(){return this.hasNext()?(this.pos++,this.value[this.pos]):null},t.prototype.lookAhead=function(t){return void 0===t&&(t=1),this.pos+t>=this.value.length?a.ITERATION_STATUS.EO_STRM:this.value[this.pos+t]},t.prototype[Symbol.iterator]=function(){var t=this;return{next:function(){return{done:!t.hasNext(),value:t.next()}}}},t.prototype.reset=function(){this.pos=-1},t}();e.Stream=u;var l=function(){function t(t){this._limits=-1,this.pos=-1,this.dataSource=t}return t.of=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t(new(a.ArrayStreamDataSource.bind.apply(a.ArrayStreamDataSource,o([void 0],n(e),!1))))},t.ofAssoc=function(t){return this.of.apply(this,o([],n(Object.keys(t)),!1)).map((function(e){return[e,t[e]]}))},t.ofStreamDataSource=function(e){return new t(e)},t.prototype.hasNext=function(){return!this.isOverLimits()&&this.dataSource.hasNext()},t.prototype.next=function(){var t=this.dataSource.next();return this.pos++,t},t.prototype.lookAhead=function(t){return void 0===t&&(t=1),this.dataSource.lookAhead(t)},t.prototype.current=function(){return this.dataSource.current()},t.prototype.reset=function(){this.dataSource.reset(),this.pos=-1,this._limits=-1},t.prototype.concat=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.of.apply(t,o([this],n(e),!1)).flatMap((function(t){return t}))},t.prototype.nextFilter=function(t){if(this.hasNext()){var e=this.next();return t(e)?e:this.nextFilter(t)}return null},t.prototype.limits=function(t){return this._limits=t,this},t.prototype.collect=function(t){for(;this.hasNext();){var e=this.next();t.collect(e)}return this.reset(),t.finalValue},t.prototype.onElem=function(e){var r=this;return new t(new a.MappedStreamDataSource((function(t){return!1===e(t,r.pos)&&r.stop(),t}),this))},t.prototype.filter=function(e){return new t(new a.FilteredStreamDatasource(e,this))},t.prototype.map=function(e){return new t(new a.MappedStreamDataSource(e,this))},t.prototype.flatMap=function(e){return new t(new a.FlatMapStreamDataSource(e,this))},t.prototype.each=function(t){for(;this.hasNext();)!1===t(this.next())&&this.stop();this.reset()},t.prototype.reduce=function(t,e){if(void 0===e&&(e=null),!this.hasNext())return i.Optional.absent;var r,n=null;if(null!=e)r=e,n=this.next();else{if(r=this.next(),!this.hasNext())return i.Optional.fromNullable(r);n=this.next()}for(r=t(r,n);this.hasNext();)r=t(r,n=this.next());return this.reset(),i.Optional.fromNullable(r)},t.prototype.last=function(){return this.hasNext()?this.reduce((function(t,e){return e})):i.Optional.absent},t.prototype.first=function(){return this.reset(),this.hasNext()?i.Optional.fromNullable(this.next()):i.Optional.absent},t.prototype.anyMatch=function(t){for(;this.hasNext();)if(t(this.next()))return!0;return!1},t.prototype.allMatch=function(t){for(;this.hasNext();)if(!t(this.next()))return!1;return!0},t.prototype.noneMatch=function(t){for(;this.hasNext();)if(t(this.next()))return!1;return!0},t.prototype.sort=function(e){var r=this.collect(new a.ArrayCollector);return r=r.sort(e),t.of.apply(t,o([],n(r),!1))},Object.defineProperty(t.prototype,"value",{get:function(){return this.collect(new a.ArrayCollector)},enumerable:!1,configurable:!0}),t.prototype[Symbol.iterator]=function(){var t=this;return{next:function(){return{done:!t.hasNext(),value:t.next()}}}},t.prototype.stop=function(){this.pos=this._limits+1e9,this._limits=0},t.prototype.isOverLimits=function(){return-1!=this._limits&&this.pos>=this._limits-1},t}();e.LazyStream=l},356:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.TagBuilder=void 0;var i=r(585),a=r(456);void 0!==a._global$&&function(){if(void 0!==(0,a._global$)().Reflect&&void 0!==(0,a._global$)().customElements&&!(0,a._global$)().customElements.polyfillWrapFlushCallback){var t=HTMLElement;(0,a._global$)().HTMLElement={HTMLElement:function(){return Reflect.construct(t,[],this.constructor)}}.HTMLElement,HTMLElement.prototype=t.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,t)}}();var u=function(){function t(t){this.extendsType=HTMLElement,this.observedAttrs=[],this.tagName=t}return t.withTagName=function(e){return new t(e)},t.prototype.withObservedAttributes=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.observedAttrs=t},t.prototype.withConnectedCallback=function(t){return this.connectedCallback=t,this},t.prototype.withDisconnectedCallback=function(t){return this.disconnectedCallback=t,this},t.prototype.withAdoptedCallback=function(t){return this.adoptedCallback=t,this},t.prototype.withAttributeChangedCallback=function(t){return this.attributeChangedCallback=t,this},t.prototype.withExtendsType=function(t){return this.extendsType=t,this},t.prototype.withOptions=function(t){return this.theOptions=t,this},t.prototype.withClass=function(t){if(this.markup)throw Error("Markup already defined, markup must be set in the class");return this.clazz=t,this},t.prototype.withMarkup=function(t){if(this.clazz)throw Error("Class already defined, markup must be set in the class");return this.markup=t,this},t.prototype.register=function(){var t=this;if(!this.clazz&&!this.markup)throw Error("Class or markup must be defined");if(this.clazz){var e=function(e){var r=t[e],n=t.clazz.prototype[e],o=r||n;o&&(t.clazz.prototype[e]=function(){r?o.apply(i.DomQuery.byId(this)):n.apply(this)})};e("connectedCallback"),e("disconnectedCallback"),e("adoptedCallback"),e("attributeChangedCallback"),this.observedAttrs.length&&Object.defineProperty(this.clazz.prototype,"observedAttributes",{get:function(){return this.observedAttrs}}),(0,a._global$)().customElements.define(this.tagName,this.clazz,this.theOptions||null)}else{var r=this,n=function(t,e){r[t]&&r[t].apply(i.DomQuery.byId(e))};(0,a._global$)().customElements.define(this.tagName,function(t){function e(){var e=t.call(this)||this;return e.innerHTML=r.markup,e}return o(e,t),Object.defineProperty(e,"observedAttributes",{get:function(){return r.observedAttrs},enumerable:!1,configurable:!0}),e.prototype.connectedCallback=function(){n("connectedCallback",this)},e.prototype.disconnectedCallback=function(){n("disconnectedCallback",this)},e.prototype.adoptedCallback=function(){n("adoptedCallback",this)},e.prototype.attributeChangedCallback=function(){n("attributeChangedCallback",this)},e}(this.extendsType),this.theOptions||null)}},t}();e.TagBuilder=u},121:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.XQ=e.XMLQuery=void 0;var i=r(805),a=r(585),u=i.Lang.isString,l=r(456),s=function(t){function e(e,r){void 0===r&&(r="text/xml");var n;return u(e)?t.call(this,null==(n=e)?null:i.Lang.saveResolveLazy((function(){return new((0,l._global$)().DOMParser)}),(function(){return(t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,{parseFromString:function(e,r){return t.loadXML(e)}};var t})).value.parseFromString(n,r))||this:t.call(this,e)||this}return o(e,t),e.prototype.isXMLParserError=function(){return this.querySelectorAll("parsererror").isPresent()},e.prototype.toString=function(){var t=[];return this.eachElem((function(e){var r,n,o,i,a=null!==(i=null===(o=null===(n=null===(r=(0,l._global$)())||void 0===r?void 0:r.XMLSerializer)||void 0===n?void 0:n.constructor())||void 0===o?void 0:o.serializeToString(e))&&void 0!==i?i:null==e?void 0:e.xml;a&&t.push(a)})),t.join("")},e.prototype.parserErrorText=function(t){return this.querySelectorAll("parsererror").textContent(t)},e.parseXML=function(t){return new e(t)},e.parseHTML=function(t){return new e(t,"text/html")},e.fromString=function(t,r){return void 0===r&&(r="text/xml"),new e(t,r)},e}(a.DomQuery);e.XMLQuery=s,e.XQ=s},832:function(e){e.exports=t}},r={};function n(t){var o=r[t];if(void 0!==o)return o.exports;var i=r[t]={exports:{}};return e[t].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();var o={};return function(){var t=o;Object.defineProperty(t,"__esModule",{value:!0}),t.ExpiringCrypto=t.JSONCrypto=t.NoCrypto=t.BroadcastChannelBroker=t.Broker=t.Message=t.TagBuilder=t.QueryFormDataCollector=t.FormDataCollector=t.AssocArrayCollector=t.ArrayCollector=t.QueryFormStringCollector=t.SequenceDataSource=t.FlatMapStreamDataSource=t.FilteredStreamDatasource=t.MappedStreamDataSource=t.ArrayStreamDataSource=t.LazyStream=t.Stream=t.XQ=t.XMLQuery=t.PromiseStatus=t.CancellablePromise=t.ValueEmbedder=t.Optional=t.Monad=t.Config=t.Lang=t.DQ$=t.DQ=t.DomQueryCollector=t.ElementAttribute=t.DomQuery=void 0;var e=n(585);Object.defineProperty(t,"DomQuery",{enumerable:!0,get:function(){return e.DomQuery}}),Object.defineProperty(t,"ElementAttribute",{enumerable:!0,get:function(){return e.ElementAttribute}}),Object.defineProperty(t,"DomQueryCollector",{enumerable:!0,get:function(){return e.DomQueryCollector}}),Object.defineProperty(t,"DQ",{enumerable:!0,get:function(){return e.DQ}}),Object.defineProperty(t,"DQ$",{enumerable:!0,get:function(){return e.DQ$}});var r=n(805);Object.defineProperty(t,"Lang",{enumerable:!0,get:function(){return r.Lang}});var i=n(152);Object.defineProperty(t,"Config",{enumerable:!0,get:function(){return i.Config}}),Object.defineProperty(t,"Monad",{enumerable:!0,get:function(){return i.Monad}}),Object.defineProperty(t,"Optional",{enumerable:!0,get:function(){return i.Optional}}),Object.defineProperty(t,"ValueEmbedder",{enumerable:!0,get:function(){return i.ValueEmbedder}});var a=n(376);Object.defineProperty(t,"CancellablePromise",{enumerable:!0,get:function(){return a.CancellablePromise}}),Object.defineProperty(t,"PromiseStatus",{enumerable:!0,get:function(){return a.PromiseStatus}});var u=n(121);Object.defineProperty(t,"XMLQuery",{enumerable:!0,get:function(){return u.XMLQuery}}),Object.defineProperty(t,"XQ",{enumerable:!0,get:function(){return u.XQ}});var l=n(551);Object.defineProperty(t,"Stream",{enumerable:!0,get:function(){return l.Stream}}),Object.defineProperty(t,"LazyStream",{enumerable:!0,get:function(){return l.LazyStream}});var s=n(255);Object.defineProperty(t,"ArrayStreamDataSource",{enumerable:!0,get:function(){return s.ArrayStreamDataSource}}),Object.defineProperty(t,"MappedStreamDataSource",{enumerable:!0,get:function(){return s.MappedStreamDataSource}}),Object.defineProperty(t,"FilteredStreamDatasource",{enumerable:!0,get:function(){return s.FilteredStreamDatasource}}),Object.defineProperty(t,"FlatMapStreamDataSource",{enumerable:!0,get:function(){return s.FlatMapStreamDataSource}}),Object.defineProperty(t,"SequenceDataSource",{enumerable:!0,get:function(){return s.SequenceDataSource}}),Object.defineProperty(t,"QueryFormStringCollector",{enumerable:!0,get:function(){return s.QueryFormStringCollector}}),Object.defineProperty(t,"ArrayCollector",{enumerable:!0,get:function(){return s.ArrayCollector}}),Object.defineProperty(t,"AssocArrayCollector",{enumerable:!0,get:function(){return s.AssocArrayCollector}}),Object.defineProperty(t,"FormDataCollector",{enumerable:!0,get:function(){return s.FormDataCollector}}),Object.defineProperty(t,"QueryFormDataCollector",{enumerable:!0,get:function(){return s.QueryFormDataCollector}});var c=n(356);Object.defineProperty(t,"TagBuilder",{enumerable:!0,get:function(){return c.TagBuilder}});var p=n(493);Object.defineProperty(t,"Message",{enumerable:!0,get:function(){return p.Message}}),Object.defineProperty(t,"Broker",{enumerable:!0,get:function(){return p.Broker}}),Object.defineProperty(t,"BroadcastChannelBroker",{enumerable:!0,get:function(){return p.BroadcastChannelBroker}}),Object.defineProperty(t,"NoCrypto",{enumerable:!0,get:function(){return p.NoCrypto}});var h=n(391);Object.defineProperty(t,"JSONCrypto",{enumerable:!0,get:function(){return h.JSONCrypto}}),Object.defineProperty(t,"ExpiringCrypto",{enumerable:!0,get:function(){return h.ExpiringCrypto}})}(),o}()}));
//# sourceMappingURL=index.js.map