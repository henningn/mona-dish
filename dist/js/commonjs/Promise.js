!function(t,n){for(var e in n)t[e]=n[e]}(exports,function(t){var n={};function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(n){return t[n]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=3)}([function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t){this._value=t}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),t.prototype.map=function(n){return n||(n=function(t){return t}),new t(n(this.value))},t.prototype.flatMap=function(n){for(var e,r=this.map(n);(null===(e=r)||void 0===e?void 0:e.value)instanceof t;)r=r.value;return r},t}();n.Monad=o;var s=function(t){function n(n){return t.call(this,n)||this}return i(n,t),Object.defineProperty(n.prototype,"value",{get:function(){return this._value instanceof o?this._value.flatMap().value:this._value},enumerable:!0,configurable:!0}),n.fromNullable=function(t){return new n(t)},n.prototype.isAbsent=function(){return void 0===this.value||null==this.value},n.prototype.isPresent=function(t){var n=this.isAbsent();return!n&&t&&t.call(this,this),!n},n.prototype.ifPresentLazy=function(t){return void 0===t&&(t=function(){}),this.isPresent.call(this,t),this},n.prototype.orElse=function(t){return this.isPresent()?this:null==t?n.absent:this.flatMap((function(){return t}))},n.prototype.orElseLazy=function(t){return this.isPresent()?this:this.flatMap(t)},n.prototype.flatMap=function(e){var r=t.prototype.flatMap.call(this,e);return r instanceof n?r.flatMap():n.fromNullable(r.value)},n.prototype.getIf=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var e=this,r=0;r<t.length;r++){var i=this.keyVal(t[r]),o=this.arrayIndex(t[r]);if(""===i&&o>=0){if((e=this.getClass().fromNullable(e.value instanceof Array?e.value.length<o?null:e.value[o]:null)).isAbsent())return e}else if(i&&o>=0){if(e.getIfPresent(i).isAbsent())return e;if((e=e.getIfPresent(i).value instanceof Array?this.getClass().fromNullable(e.getIfPresent(i).value[o]):this.getClass().absent).isAbsent())return e}else{if((e=e.getIfPresent(i)).isAbsent())return e;o>-1&&(e=this.getClass().fromNullable(e.value[o]))}}return e},n.prototype.match=function(t){return!this.isAbsent()&&t(this.value)},n.prototype.get=function(t){return void 0===t&&(t=n.absent),this.isAbsent()?this.getClass().fromNullable(t).flatMap():this.getClass().fromNullable(this.value).flatMap()},n.prototype.toJson=function(){return JSON.stringify(this.value)},n.prototype.getClass=function(){return n},n.prototype.arrayIndex=function(t){var n=t.indexOf("["),e=t.indexOf("]");return n>=0&&e>0&&n<e?parseInt(t.substring(n+1,e)):-1},n.prototype.keyVal=function(t){var n=t.indexOf("[");return n>=0?t.substring(0,n):t},n.prototype.getIfPresent=function(t){return this.isAbsent()?this.getClass().absent:this.getClass().fromNullable(this.value[t]).flatMap()},n.prototype.resolve=function(t){if(this.isAbsent())return n.absent;try{return n.fromNullable(t(this.value))}catch(t){return n.absent}},n.absent=n.fromNullable(null),n}(o);n.Optional=s;var u=function(t){function n(n,e){void 0===e&&(e="value");var r=t.call(this,n)||this;return r.key=e,r}return i(n,t),Object.defineProperty(n.prototype,"value",{get:function(){return this._value?this._value[this.key]:null},set:function(t){this._value&&(this._value[this.key]=t)},enumerable:!0,configurable:!0}),n.prototype.orElse=function(t){var e={};return e[this.key]=t,this.isPresent()?this:new n(e,this.key)},n.prototype.orElseLazy=function(t){if(this.isPresent())return this;var e={};return e[this.key]=t(),new n(e,this.key)},n.prototype.getClass=function(){return n},n.fromNullable=function(t,e){return void 0===e&&(e="value"),new n(t,e)},n.absent=n.fromNullable(null),n}(s);n.ValueEmbedder=u},,,function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(n,"__esModule",{value:!0});var o,s=e(0);!function(t){t[t.PENDING=0]="PENDING",t[t.FULLFILLED=1]="FULLFILLED",t[t.REJECTED=2]="REJECTED"}(o=n.PromiseStatus||(n.PromiseStatus={}));var u=function(){function t(t){var n=this;this.status=o.PENDING,this.allFuncs=[],this.value=t,this.value((function(t){return n.resolve(t)}),(function(t){return n.reject(t)}))}return t.all=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r,i=0,o=new t((function(t,n){r=t})),s=function(){i++,n.length==i&&r()};s.__last__=!0;for(var u=0;u<n.length;u++)n[u].finally(s);return o},t.race=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r,i,o=new t((function(t,n){r=t,i=n})),s=function(){return r&&r(),r=null,i=null,null};s.__last__=!0;var u=function(){return i&&i(),i=null,r=null,null};u.__last__=!0;for(var l=0;l<n.length;l++)n[l].then(s),n[l].catch(u);return o},t.reject=function(n){return new t((function(e,r){n instanceof t?n.then((function(t){r(t)})):setTimeout((function(){r(n)}),1)}))},t.resolve=function(n){return new t((function(e,r){n instanceof t?n.then((function(t){return e(t)})):setTimeout((function(){e(n)}),1)}))},t.prototype.then=function(t,n){return this.allFuncs.push({then:t}),n&&this.allFuncs.push({catch:n}),this.spliceLastFuncs(),this},t.prototype.catch=function(t){return this.allFuncs.push({catch:t}),this.spliceLastFuncs(),this},t.prototype.finally=function(t){if(!this.__reason__)return this.allFuncs.push({finally:t}),this.spliceLastFuncs(),this;this.__reason__.finally(t)},t.prototype.resolve=function(n){for(;this.allFuncs.length&&this.allFuncs[0].then;){var e=this.allFuncs.shift(),r=s.Optional.fromNullable(e.then(n));if(!r.isPresent())break;if((n=(r=r.flatMap()).value)instanceof t)return void this.transferIntoNewPromise(n)}this.appyFinally(),this.status=o.FULLFILLED},t.prototype.reject=function(n){for(;this.allFuncs.length&&!this.allFuncs[0].finally;){var e=this.allFuncs.shift();if(e.catch){var r=s.Optional.fromNullable(e.catch(n));if(r.isPresent()){if((n=(r=r.flatMap()).value)instanceof t)return void this.transferIntoNewPromise(n);this.status=o.REJECTED;break}break}}this.status=o.REJECTED,this.appyFinally()},t.prototype.appyFinally=function(){for(;this.allFuncs.length;){var t=this.allFuncs.shift();t.finally&&t.finally()}},t.prototype.spliceLastFuncs=function(){for(var t=[],n=[],e=0;e<this.allFuncs.length;e++)for(var r in this.allFuncs[e])this.allFuncs[e][r].__last__?t.push(this.allFuncs[e]):n.push(this.allFuncs[e]);this.allFuncs=n.concat(t)},t.prototype.transferIntoNewPromise=function(t){for(var n=0;n<this.allFuncs.length;n++)for(var e in this.allFuncs[n])t[e](this.allFuncs[n][e])},t}();n.Promise=u;var l=function(t){function n(n,e){var r=t.call(this,n)||this;return r.cancellator=function(){},r.cancellator=e,r}return i(n,t),n.prototype.cancel=function(){this.status=o.REJECTED,this.appyFinally(),this.allFuncs=[]},n.prototype.then=function(n,e){return t.prototype.then.call(this,n,e)},n.prototype.catch=function(n){return t.prototype.catch.call(this,n)},n.prototype.finally=function(n){return t.prototype.finally.call(this,n)},n}(u);n.CancellablePromise=l}]));
//# sourceMappingURL=Promise.js.map