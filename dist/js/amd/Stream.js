define((function(){return function(t){var e={};function s(l){if(e[l])return e[l].exports;var r=e[l]={i:l,l:!1,exports:{}};return t[l].call(r.exports,r,r.exports,s),r.l=!0,r.exports}return s.m=t,s.c=e,s.d=function(t,e,l){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:l})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var l=Object.create(null);if(s.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(l,r,function(e){return t[e]}.bind(null,r));return l},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=4)}([function(t,e,s){"use strict";s.r(e),s.d(e,"Monad",(function(){return r})),s.d(e,"Optional",(function(){return n})),s.d(e,"ValueEmbedder",(function(){return i})),s.d(e,"Config",(function(){return u}));var l=s(1);class r{constructor(t){this._value=t}get value(){return this._value}map(t){t||(t=t=>t);let e=t(this.value);return new r(e)}flatMap(t){let e=this.map(t);for(;void 0!==e&&null!=e&&e.value instanceof r;)e=e.value;return e}}class n extends r{constructor(t){super(t)}get value(){return this._value instanceof r?this._value.flatMap().value:this._value}static fromNullable(t){return new n(t)}isAbsent(){return void 0===this.value||null==this.value}isPresent(t){let e=this.isAbsent();return!e&&t&&t.call(this,this),!e}ifPresentLazy(t=(()=>{})){return this.isPresent.call(this,t),this}orElse(t){return this.isPresent()?this:null==t?n.absent:this.flatMap(()=>t)}orElseLazy(t){return this.isPresent()?this:this.flatMap(t)}flatMap(t){let e=super.flatMap(t);return e instanceof n?e.flatMap():n.fromNullable(e.value)}getIf(...t){let e=this;for(let s=0;s<t.length;s++){let l=this.keyVal(t[s]),r=this.arrayIndex(t[s]);if(""===l&&r>=0){if((e=this.getClass().fromNullable(e.value instanceof Array?e.value.length<r?null:e.value[r]:null)).isAbsent())return e}else if(l&&r>=0){if(e.getIfPresent(l).isAbsent())return e;if((e=e.getIfPresent(l).value instanceof Array?this.getClass().fromNullable(e.getIfPresent(l).value[r]):this.getClass().absent).isAbsent())return e}else{if((e=e.getIfPresent(l)).isAbsent())return e;r>-1&&(e=this.getClass().fromNullable(e.value[r]))}}return e}match(t){return!this.isAbsent()&&t(this.value)}get(t=n.absent){return this.isAbsent()?this.getClass().fromNullable(t).flatMap():this.getClass().fromNullable(this.value).flatMap()}toJson(){return JSON.stringify(this.value)}getClass(){return n}arrayIndex(t){let e=t.indexOf("["),s=t.indexOf("]");return e>=0&&s>0&&e<s?parseInt(t.substring(e+1,s)):-1}keyVal(t){let e=t.indexOf("[");return e>=0?t.substring(0,e):t}getIfPresent(t){return this.isAbsent()?this.getClass().absent:this.getClass().fromNullable(this.value[t]).flatMap()}resolve(t){if(this.isAbsent())return n.absent;try{return n.fromNullable(t(this.value))}catch(t){return n.absent}}}n.absent=n.fromNullable(null);class i extends n{constructor(t,e="value"){super(t),this.key=e}get value(){return this._value?this._value[this.key]:null}set value(t){this._value&&(this._value[this.key]=t)}orElse(t){let e={};return e[this.key]=t,this.isPresent()?this:new i(e,this.key)}orElseLazy(t){if(this.isPresent())return this;{let e={};return e[this.key]=t(),new i(e,this.key)}}getClass(){return i}static fromNullable(t,e="value"){return new i(t,e)}}i.absent=i.fromNullable(null);class a extends i{constructor(t,e,s){super(t,e),this.arrPos=void 0!==s?s:-1}get value(){return""==this.key&&this.arrPos>=0?this._value[this.arrPos]:this.key&&this.arrPos>=0?this._value[this.key][this.arrPos]:this._value[this.key]}set value(t){""==this.key&&this.arrPos>=0?this._value[this.arrPos]=t:this.key&&this.arrPos>=0?this._value[this.key][this.arrPos]=t:this._value[this.key]=t}}a.absent=a.fromNullable(null);class u extends n{constructor(t){super(t)}get shallowCopy(){return new u(l.Lang.instance.mergeMaps([{},this.value||{}]))}static fromNullable(t){return new u(t)}shallowMerge(t,e=!0){for(let s in t.value)e&&s in this.value?this.apply(s).value=t.getIf(s).value:s in this.value||(this.apply(s).value=t.getIf(s).value)}apply(...t){if(t.length<1)return;this.buildPath(t);let e=this.keyVal(t[t.length-1]),s=this.arrayIndex(t[t.length-1]);return new a(1==t.length?this.value:this.getIf.apply(this,t.slice(0,t.length-1)).value,e,s)}applyIf(t,...e){return t?this.apply(...e):{value:null}}getIf(...t){return this.getClass().fromNullable(super.getIf.apply(this,t).value)}get(t){return this.getClass().fromNullable(super.get(t).value)}delete(t){return t in this.value&&delete this.value[t],this}toJson(){return JSON.stringify(this.value)}getClass(){return u}setVal(t){this._value=t}buildPath(t){let e=this,s=this.getClass().fromNullable(null),l=-1,r=function(t,e){if(t.length<e)for(let s=t.length;s<e;s++)t.push({})};for(let n=0;n<t.length;n++){let i=this.keyVal(t[n]),a=this.arrayIndex(t[n]);if(""===i&&a>=0){e.setVal(e.value instanceof Array?e.value:[]),r(e.value,a+1),l>=0&&(s.value[l]=e.value),s=e,l=a,e=this.getClass().fromNullable(e.value[a]);continue}let u=e.getIf(i);if(-1==a)u.isAbsent()?u=this.getClass().fromNullable(e.value[i]={}):e=u;else{let t=u.value instanceof Array?u.value:[];r(t,a+1),e.value[i]=t,u=this.getClass().fromNullable(t[a])}s=e,l=a,e=u}return this}}},function(t,e,s){"use strict";s.r(e),s.d(e,"Lang",(function(){return n}));var l=s(3),r=s(0);class n{static get instance(){return n._instance||(n._instance=new n),n._instance}static saveResolve(t,e=null){try{let s=t();return void 0===s||null==s?r.Optional.fromNullable(e):r.Optional.fromNullable(s)}catch(t){return r.Optional.absent}}static saveResolveLazy(t,e=null){try{let s=t();return void 0===s||null==s?r.Optional.fromNullable(e()):r.Optional.fromNullable(s)}catch(t){return r.Optional.absent}}strToArray(t,e=/\./gi){let s=t.split(e);for(let t=0;t<s.length;t++)s[t]=this.trim(s[t]);return s}arrToMap(t,e=0){var s=new Array(t.length),l=t.length;e=e||0;for(var r=0;r<l;r++)s[t[r]]=r+e;return s}trim(t){let e=/\s/,s=(t=t.replace(/^\s\s*/,"")).length;for(;e.test(t.charAt(--s)););return t.slice(0,s+1)}isString(t){return!!arguments.length&&null!=t&&("string"==typeof t||t instanceof String)}isFunc(t){return t instanceof Function||"function"==typeof t}hitch(t,e){return t?function(){return e.apply(t,arguments||[])}:e}mergeMaps(t,e=!0,s=(t=>!1),l=(t=>!0)){let r={};return this.arrForEach(t,t=>{this.mixMaps(r,t,e,s,l)}),r}mixMaps(t,e,s,l,r){for(let n in e)e.hasOwnProperty(n)&&(l&&l(n)||r&&!r(n)||(t[n]=s?void 0!==e[n]?e[n]:t[n]:void 0!==t[n]?t[n]:e[n]));return t}objToArray(t,e,s){if(!t)return s||null;if(t instanceof Array&&!e&&!s)return t;let l=void 0!==e||null!=e?e:0,r=s||[];try{return r.concat(Array.prototype.slice.call(t,l))}catch(e){for(let e=l;e<t.length;e++)r.push(t[e]);return r}}arrForEach(t,e,s,l){if(!t||!t.length)return;let r=s||0,n=l,i=this.objToArray(t);s?i.slice(r).forEach(e,n):i.forEach(e,n)}contains(t,e){if(!t||!e)throw Error("null value on arr or str not allowed");return-1!=this.arrIndexOf(t,e)}arrIndexOf(t,e,s){if(!t||!t.length)return-1;let l=s||0;return(t=this.objToArray(t)).indexOf(e,l)}arrFilter(t,e,s,l){if(!t||!t.length)return[];let r=this.objToArray(t);return s?r.slice(s).filter(e,l):r.filter(e,l)}applyArgs(t,e,s){let l="undefined";if(s)for(let r=0;r<e.length;r++)l!=typeof t["_"+s[r]]&&(t["_"+s[r]]=e[r]),l!=typeof t[s[r]]&&(t[s[r]]=e[r]);else for(let s in e)e.hasOwnProperty(s)&&(l!=typeof t["_"+s]&&(t["_"+s]=e[s]),l!=typeof t[s]&&(t[s]=e[s]));return t}equalsIgnoreCase(t,e){return!t&&!e||!(!t||!e)&&t.toLowerCase()===e.toLowerCase()}timeout(t){let e=null;return new l.CancellablePromise((s,l)=>{e=setTimeout(()=>{s()},t)},()=>{e&&(clearTimeout(e),e=null)})}interval(t){let e=null;return new l.CancellablePromise((s,l)=>{e=setInterval(()=>{s()},t)},()=>{e&&(clearInterval(e),e=null)})}assertType(t,e){return this.isString(e)?typeof t==e:t instanceof e}}},function(t,e,s){"use strict";s.d(e,"b",(function(){return r})),s.d(e,"c",(function(){return n})),s.d(e,"f",(function(){return i})),s.d(e,"d",(function(){return a})),s.d(e,"a",(function(){return u})),s.d(e,"e",(function(){return h})),s.d(e,"g",(function(){return o})),s.d(e,"h",(function(){return c}));var l=s(4);class r{constructor(...t){this.dataPos=-1,this.value=t}hasNext(){return this.value.length-1>this.dataPos}next(){return this.dataPos++,this.value[this.dataPos]}reset(){this.dataPos=-1}}class n{constructor(t,e){this.filteredNext=null,this.filterFunc=t,this.inputDataSource=e}hasNext(){for(;null==this.filteredNext&&this.inputDataSource.hasNext();){let t=this.inputDataSource.next();if(this.filterFunc(t))return this.filteredNext=t,!0;this.filteredNext=null}return null!=this.filteredNext}next(){let t=this.filteredNext;return this.filteredNext=null,this.hasNext(),t}reset(){this.filteredNext=null,this.inputDataSource.reset()}}class i{constructor(t,e){this.mapFunc=t,this.inputDataSource=e}hasNext(){return this.inputDataSource.hasNext()}next(){return this.mapFunc(this.inputDataSource.next())}reset(){this.inputDataSource.reset()}}class a{constructor(t,e){this.mapFunc=t,this.inputDataSource=e}hasNext(){return this.resolveCurrentNext()||this.resolveNextNext()}resolveCurrentNext(){let t=!1;return this.activeDataSource&&(t=this.activeDataSource.hasNext()),t}resolveNextNext(){let t=!1;for(;!t&&this.inputDataSource.hasNext();)this.activeDataSource=this.mapFunc(this.inputDataSource.next()),t=this.activeDataSource.hasNext();return t}next(){return this.activeDataSource.next()}reset(){this.inputDataSource.reset()}}class u{constructor(){this.data=[]}collect(t){this.data.push(t)}get finalValue(){return this.data}}class h{constructor(){this.finalValue=new FormData}collect(t){this.finalValue.append(t.key,t.value)}}class o{constructor(){this.finalValue=new FormData}collect(t){let e=t.encodeFormElement();e.isPresent()&&this.finalValue.append(t.name.value,e.get(t.name).value)}}class c{constructor(){this.formData=[]}collect(t){let e=t.encodeFormElement();e.isPresent()&&this.formData.push([t.name.value,e.get(t.name).value])}get finalValue(){return l.Stream.of(...this.formData).map(t=>t.join("=")).reduce((t,e)=>[t,e].join("&")).orElse("").value}}},function(t,e,s){"use strict";s.r(e),s.d(e,"PromiseStatus",(function(){return l})),s.d(e,"Promise",(function(){return n})),s.d(e,"CancellablePromise",(function(){return i}));var l,r=s(0);!function(t){t[t.PENDING=0]="PENDING",t[t.FULLFILLED=1]="FULLFILLED",t[t.REJECTED=2]="REJECTED"}(l||(l={}));class n{constructor(t){this.status=l.PENDING,this.allFuncs=[],this.value=t,this.value(t=>this.resolve(t),t=>this.reject(t))}static all(...t){let e,s=0,l=new n((t,s)=>{e=t}),r=()=>{s++,t.length==s&&e()};r.__last__=!0;for(let e=0;e<t.length;e++)t[e].finally(r);return l}static race(...t){let e,s,l=new n((t,l)=>{e=t,s=l}),r=()=>(e&&e(),e=null,s=null,null);r.__last__=!0;let i=()=>(s&&s(),s=null,e=null,null);i.__last__=!0;for(let e=0;e<t.length;e++)t[e].then(r),t[e].catch(i);return l}static reject(t){return new n((e,s)=>{t instanceof n?t.then(t=>{s(t)}):setTimeout(()=>{s(t)},1)})}static resolve(t){return new n((e,s)=>{t instanceof n?t.then(t=>e(t)):setTimeout(()=>{e(t)},1)})}then(t,e){return this.allFuncs.push({then:t}),e&&this.allFuncs.push({catch:e}),this.spliceLastFuncs(),this}catch(t){return this.allFuncs.push({catch:t}),this.spliceLastFuncs(),this}finally(t){if(!this.__reason__)return this.allFuncs.push({finally:t}),this.spliceLastFuncs(),this;this.__reason__.finally(t)}resolve(t){for(;this.allFuncs.length&&this.allFuncs[0].then;){let e=this.allFuncs.shift(),s=r.Optional.fromNullable(e.then(t));if(!s.isPresent())break;if((t=(s=s.flatMap()).value)instanceof n)return void this.transferIntoNewPromise(t)}this.appyFinally(),this.status=l.FULLFILLED}reject(t){for(;this.allFuncs.length&&!this.allFuncs[0].finally;){var e=this.allFuncs.shift();if(e.catch){var s=r.Optional.fromNullable(e.catch(t));if(s.isPresent()){if((t=(s=s.flatMap()).value)instanceof n)return void this.transferIntoNewPromise(t);this.status=l.REJECTED;break}break}}this.status=l.REJECTED,this.appyFinally()}appyFinally(){for(;this.allFuncs.length;){var t=this.allFuncs.shift();t.finally&&t.finally()}}spliceLastFuncs(){let t=[],e=[];for(let s=0;s<this.allFuncs.length;s++)for(let l in this.allFuncs[s])this.allFuncs[s][l].__last__?t.push(this.allFuncs[s]):e.push(this.allFuncs[s]);this.allFuncs=e.concat(t)}transferIntoNewPromise(t){for(var e=0;e<this.allFuncs.length;e++)for(let s in this.allFuncs[e])t[s](this.allFuncs[e][s])}}class i extends n{constructor(t,e){super(t),this.cancellator=()=>{},this.cancellator=e}cancel(){this.status=l.REJECTED,this.appyFinally(),this.allFuncs=[]}then(t,e){return super.then(t,e)}catch(t){return super.catch(t)}finally(t){return super.finally(t)}}},function(t,e,s){"use strict";s.r(e),s.d(e,"Stream",(function(){return n})),s.d(e,"LazyStream",(function(){return i}));var l=s(0),r=s(2);class n{constructor(...t){this._limits=-1,this.pos=-1,this.value=t}static of(...t){return new n(...t)}static ofDataSource(t){let e=[];for(;t.hasNext();)e.push(t.next());return new n(...e)}limits(t){return this._limits=t,this}onElem(t){for(let e=0;e<this.value.length&&(-1==this._limits||e<this._limits)&&!1!==t(this.value[e],e);e++);return this}each(t){this.onElem(t)}map(t){t||(t=t=>t);let e=[];return this.each((s,l)=>{e.push(t(s))}),new n(...e)}flatMap(t){let e=[];return this.each(s=>{let l=t(s);e=e.concat(...l.value)}),n.of(...e)}filter(t){let e=[];return this.each(s=>{t(s)&&e.push(s)}),new n(...e)}reduce(t,e=null){let s=null!=e?0:1,r=null!=e?e:this.value.length?this.value[0]:null;for(let e=s;e<this.value.length&&(-1==this._limits||e<this._limits);e++)r=t(r,this.value[e]);return l.Optional.fromNullable(r)}first(){return this.value&&this.value.length?l.Optional.fromNullable(this.value[0]):l.Optional.absent}last(){let t=this._limits>0?Math.min(this._limits,this.value.length):this.value.length;return l.Optional.fromNullable(t?this.value[t-1]:null)}anyMatch(t){for(let e=0;e<this.value.length&&(-1==this._limits||e<this._limits);e++)if(t(this.value[e]))return!0;return!1}allMatch(t){if(!this.value.length)return!1;let e=0;for(let s=0;s<this.value.length;s++)t(this.value[s])&&e++;return e==this.value.length}noneMatch(t){let e=0;for(let s=0;s<this.value.length;s++)t(this.value[s])||e++;return e==this.value.length}collect(t){return this.each(e=>t.collect(e)),t.finalValue}hasNext(){let t=-1!=this._limits&&this.pos>=this._limits-1,e=this.pos>=this.value.length-1;return!(t||e)}next(){return this.hasNext()?(this.pos++,this.value[this.pos]):null}reset(){this.pos=-1}}class i{constructor(t){this._limits=-1,this.pos=-1,this.dataSource=t}static of(...t){return new i(new r.b(...t))}static ofStreamDataSource(t){return new i(t)}hasNext(){return!this.isOverLimits()&&this.dataSource.hasNext()}next(){let t=this.dataSource.next();return this.pos++,t}reset(){this.dataSource.reset(),this.pos=0,this._limits=-1}nextFilter(t){if(this.hasNext()){let e=this.next();return t(e)?e:this.nextFilter(t)}return null}limits(t){return this._limits=t,this}collect(t){for(;this.hasNext();){let e=this.next();t.collect(e)}return t.finalValue}onElem(t){return new i(new r.f(e=>(!1===t(e,this.pos)&&this.stop(),e),this))}filter(t){return new i(new r.c(t,this))}map(t){return new i(new r.f(t,this))}flatMap(t){return new i(new r.d(t,this))}each(t){for(;this.hasNext();)!1===t(this.next())&&this.stop()}reduce(t,e=null){if(!this.hasNext())return l.Optional.absent;let s=null,r=null;if(null!=e)s=e,r=this.next();else{if(s=this.next(),!this.hasNext())return l.Optional.fromNullable(s);r=this.next()}for(s=t(s,r);this.hasNext();)s=t(s,r=this.next());return l.Optional.fromNullable(s)}last(){return this.hasNext()?this.reduce((t,e)=>e):l.Optional.absent}first(){return this.reset(),this.hasNext()?l.Optional.fromNullable(this.next()):l.Optional.absent}anyMatch(t){for(;this.hasNext();)if(t(this.next()))return!0;return!1}allMatch(t){for(;this.hasNext();)if(!t(this.next()))return!1;return!0}noneMatch(t){for(;this.hasNext();)if(t(this.next()))return!1;return!0}get value(){return this.collect(new r.a)}stop(){this.pos=this._limits+1e9}isOverLimits(){return-1!=this._limits&&this.pos>=this._limits-1}}}])}));
//# sourceMappingURL=Stream.js.map